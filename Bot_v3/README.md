# Bot Pro Ultimate v10 - Lababot

Electron-приложение для автоматизации работы с анкетами на платформах Nova/LadaDate.

## Структура файлов

```
Bot/
├── index.html          # Главный HTML файл (интерфейс)
├── css/
│   └── bot.css         # Все стили (темы, компоненты)
├── js/
│   └── bot.js          # Вся логика приложения
├── Sound/              # Звуковые уведомления
│   ├── Online.mp3
│   ├── Message.mp3
│   └── Chat.mp3
├── main.js             # Electron main process
└── package.json        # Зависимости
```

## Основные компоненты интерфейса

### Панель инструментов (toolbar)
- **+** — добавить/управлять анкетами
- **Play** — запустить все анкеты
- **Stop** — остановить все анкеты
- **Refresh** — перелогинить все анкеты
- **Settings** — глобальные настройки
- **Logger** — окно логов событий

### Вкладки (tabs)
Каждая добавленная анкета отображается как вкладка с:
- ID анкеты
- Статус (online/offline точка)
- Кнопка закрытия

### Рабочая область
Для каждой анкеты отображается:
- Список получателей (Inbox/Online/Favorites/Payers)
- Поле ввода сообщения с AI-генерацией
- Шаблоны сообщений
- Чёрный список
- Статистика отправок

## Режимы работы

| Режим | Описание |
|-------|----------|
| **Mail** | Работа с письмами (основной) |
| **Chat** | Работа с чатами |

Переключение через кнопку в панели инструментов.

## Глобальные настройки

### Интерфейс
- **Язык**: ru/en
- **Тема**: light/dark/ladadate
- **Звуки**: вкл/выкл
- **Горячие клавиши**: Ctrl+Tab для переключения вкладок

### Прокси
- Прокси для анкет по позициям (1-10, 11-20, ...)
- Прокси для .exe (общий)

### AI функции
- **OpenAI API Key** — для генерации сообщений
- **My Prompt** — пользовательский промпт
- **Промпт для ответов** — инструкция для AI при ответах

### Другое
- **Translator ID** — для отправки статистики на сервер

## Основные функции (bot.js)

### Управление анкетами
| Функция | Описание |
|---------|----------|
| `openAddModal()` | Открыть модалку добавления анкеты |
| `handleLoginOrUpdate()` | Войти/обновить анкету |
| `startBot(botId)` | Запустить анкету |
| `stopBot(botId)` | Остановить анкету |
| `startAll()` | Запустить все |
| `stopAll()` | Остановить все |
| `reloginAllBots()` | Перелогинить все |

### Работа с сообщениями
| Функция | Описание |
|---------|----------|
| `sendMessage(botId)` | Отправить сообщение |
| `openMiniChat()` | Открыть мини-чат |
| `sendMiniChatMessage()` | Отправить в мини-чате |
| `generateMiniChatAIReply()` | Сгенерировать AI ответ |

### Шаблоны
| Функция | Описание |
|---------|----------|
| `openTemplateModal()` | Добавить шаблон |
| `saveTemplateFromModal()` | Сохранить шаблон |
| `deleteTemplate()` | Удалить шаблон |
| `generateTemplateWithAI()` | Сгенерировать шаблон через AI |

### Статистика и логирование
| Функция | Описание |
|---------|----------|
| `logEvent()` | Добавить событие в лог |
| `toggleLogger()` | Показать/скрыть окно лога |
| `clearAllStats()` | Сбросить статистику |

### API Lababot сервера
| Функция | Описание |
|---------|----------|
| `sendMessageToLababot()` | Отправить исходящее сообщение |
| `sendIncomingMessageToLababot()` | Отправить входящее сообщение |
| `sendHeartbeatToLababot()` | Отправить heartbeat (статус онлайн) |
| `sendErrorToLababot()` | Отправить ошибку |
| `checkProfileStatus()` | Проверить статус анкеты |
| `checkProfilePaymentStatus()` | Проверить оплату |

## Хранение данных

Все данные хранятся в **localStorage**:

| Ключ | Описание |
|------|----------|
| `globalSettings` | Глобальные настройки |
| `botTemplates` | Шаблоны сообщений по анкетам |
| `accountPreferences` | Настройки анкет |
| `tabOrder` | Порядок вкладок |

## Темы оформления (bot.css)

### Light (по умолчанию)
Светлая тема с синими акцентами.

### Dark (Cyberpunk/Neon)
- Тёмный фон `#0d0d0d`
- Неоновые акценты: зелёный `#00ff88`, голубой `#00d4ff`
- Свечение элементов

### LadaDate
Градиентная тема с фиолетово-синими оттенками и оранжевыми акцентами.

## Интеграция с сервером

Бот отправляет данные на сервер Lababot:
```
LABABOT_SERVER = 'http://188.137.253.169:3000'
```

### Endpoints используемые ботом:
- `POST /api/messages` — отправка сообщений
- `POST /api/incoming-messages` — входящие сообщения
- `POST /api/heartbeat` — статус онлайн
- `POST /api/errors` — ошибки
- `GET /api/profiles/:id/status` — статус анкеты
- `GET /api/profiles/:id/payment-status` — статус оплаты

## Горячие клавиши

| Клавиша | Действие |
|---------|----------|
| `Ctrl+Tab` | Следующая вкладка |
| `Ctrl+Shift+Tab` | Предыдущая вкладка |

## Запуск

### Разработка (Electron)
```bash
cd Bot
npm install
npm start
```

## Переменные в шаблонах

| Переменная | Описание |
|------------|----------|
| `{City}` | Город получателя |
| `{Name}` | Имя получателя |
| `{Age}` | Возраст получателя |

## Звуковые уведомления

- **Online.mp3** — при появлении пользователя онлайн
- **Message.mp3** — при получении письма
- **Chat.mp3** — при получении чат-сообщения

Можно отключить в настройках (вкладка "Интерфейс").

## Модальные окна

| ID | Назначение |
|----|------------|
| `add-modal` | Добавление/управление анкетами |
| `tpl-modal` | Редактирование шаблона |
| `bl-modal` | Добавление в чёрный список |
| `stats-modal` | Просмотр статистики |
| `settings-modal` | Глобальные настройки |
| `minichat-modal` | Мини-чат с пользователем |
