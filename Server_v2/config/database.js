const { Pool } = require('pg');

// –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è PostgreSQL
const pool = new Pool({
    user: process.env.DB_USER || 'postgres',
    host: process.env.DB_HOST || 'localhost',
    database: process.env.DB_NAME || 'novabotbase',
    password: process.env.DB_PASSWORD || 'mikmik98',
    port: process.env.DB_PORT || 5432,
    // –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è connection pool –¥–ª—è –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
    max: 50,                      // –ú–∞–∫—Å–∏–º—É–º —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π (–±—ã–ª–æ 10 –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
    idleTimeoutMillis: 30000,     // –ó–∞–∫—Ä—ã–≤–∞—Ç—å idle —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —á–µ—Ä–µ–∑ 30 —Å–µ–∫
    connectionTimeoutMillis: 5000 // –¢–∞–π–º–∞—É—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è 5 —Å–µ–∫
});

// –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
pool.on('connect', () => {
    console.log('üì¶ –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ PostgreSQL —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ');
});

pool.on('error', (err) => {
    console.error('‚ùå –û—à–∏–±–∫–∞ PostgreSQL:', err.message);
});

module.exports = pool;
