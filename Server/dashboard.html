<!DOCTYPE html>
<html lang="ru" x-data="{ htmlLang: 'ru' }" :lang="htmlLang">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nova Dashboard</title>
    <link rel="icon" type="image/png" href="logo.png">
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Google Fonts - Inter -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Flatpickr -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
    <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
    <script src="https://cdn.jsdelivr.net/npm/flatpickr/dist/l10n/ru.js"></script>
    <!-- Localization -->
    <script src="locales.js"></script>
    <!-- Alpine.js -->
    <script src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js" defer></script>

    <!-- Configuration -->
    <script>
        // API Server URL - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –∞–¥—Ä–µ—Å —Å–µ—Ä–≤–µ—Ä–∞
        const API_BASE = window.location.origin;

        // Auth check
        const novaUserData = JSON.parse(localStorage.getItem('novaUser') || sessionStorage.getItem('novaUser') || 'null');
        if (!novaUserData || !novaUserData.loggedIn) {
            window.location.href = 'login.html';
        }

        // Load saved language or default to Russian
        const savedLanguage = localStorage.getItem('novaLanguage') || 'ru';
    </script>
    <!-- Custom Styles -->
    <link rel="stylesheet" href="public/css/common.css">
    <link rel="stylesheet" href="public/css/dashboard.css">
</head>
<body x-data="dashboard()" x-init="init()" :class="{ 'dark': darkMode }" class="text-gray-800">
    <div class="flex h-screen">
        <!-- –°–∞–π–¥–±–∞—Ä -->
        <aside class="glass-sidebar w-64 flex-shrink-0 flex flex-col p-4">
            <!-- –õ–æ–≥–æ—Ç–∏–ø -->
            <div class="mb-4">
                <a href="index.html" class="flex items-center">
                    <img src="logo.png" alt="Nova" class="h-12 w-auto">
                </a>
            </div>
            
            <!-- Menu -->
            <nav class="flex-1">
                <div class="space-y-1">
                    <div>
                        <div @click="setActiveMenu('stats')" class="menu-item flex items-center p-3 rounded-xl cursor-pointer" :class="activeMenu === 'stats' ? 'active' : ''">
                            <i class="fas fa-chart-pie w-5 text-gray-600"></i>
                            <span class="ml-3 font-medium" x-text="t('menu.statistics')"></span>
                        </div>
                    </div>
                    <div>
                        <div @click="setActiveMenu('accounts')" class="menu-item flex items-center p-3 rounded-xl cursor-pointer" :class="activeMenu === 'accounts' ? 'active' : ''">
                            <i class="fas fa-folder w-5 text-gray-600"></i>
                            <span class="ml-3 font-medium" x-text="t('menu.profiles')"></span>
                        </div>
                    </div>
                    <!-- –ö–æ–º–∞–Ω–¥–∞ - –¥–ª—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∞ –∏ –∞–¥–º–∏–Ω–∞ -->
                    <div x-show="currentUser.role === 'director' || currentUser.role === 'admin'">
                        <div @click="setActiveMenu('team')" class="menu-item flex items-center p-3 rounded-xl cursor-pointer" :class="activeMenu === 'team' ? 'active' : ''">
                            <i class="fas fa-users w-5 text-gray-600"></i>
                            <span class="ml-3 font-medium">–ö–æ–º–∞–Ω–¥–∞</span>
                        </div>
                    </div>
                    <!-- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ - —Ç–æ–ª—å–∫–æ –¥–ª—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∞ -->
                    <div x-show="currentUser.role === 'director'">
                        <div @click="setActiveMenu('control')" class="menu-item flex items-center p-3 rounded-xl cursor-pointer" :class="activeMenu === 'control' ? 'active' : ''">
                            <i class="fas fa-sliders-h w-5 text-gray-600"></i>
                            <span class="ml-3 font-medium" x-text="t('menu.control')"></span>
                        </div>
                    </div>
                    <!-- –§–∏–Ω–∞–Ω—Å—ã (—Ç–æ–ª—å–∫–æ –¥–ª—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∞) -->
                    <div x-show="currentUser.role === 'director'">
                        <div @click="setActiveMenu('finances')" class="menu-item flex items-center p-3 rounded-xl cursor-pointer" :class="activeMenu === 'finances' ? 'active' : ''">
                            <i class="fas fa-wallet w-5 text-gray-600"></i>
                            <span class="ml-3 font-medium">–§–∏–Ω–∞–Ω—Å—ã</span>
                        </div>
                    </div>
                    <div>
                        <div @click="setActiveMenu('history')" class="menu-item flex items-center p-3 rounded-xl cursor-pointer" :class="activeMenu === 'history' ? 'active' : ''">
                            <i class="fas fa-history w-5 text-gray-600"></i>
                            <span class="ml-3 font-medium" x-text="t('menu.history')"></span>
                        </div>
                    </div>
                </div>
                <!-- –û–±—É—á–µ–Ω–∏–µ –≤–Ω–∏–∑—É –æ—Ç–¥–µ–ª—å–Ω–æ -->
                <div class="mt-4 pt-4 border-t border-gray-200">
                    <div @click="setActiveMenu('training')" class="menu-item flex items-center p-3 rounded-xl cursor-pointer" :class="activeMenu === 'training' ? 'active' : ''">
                        <i class="fas fa-graduation-cap w-5 text-gray-600"></i>
                        <span class="ml-3 font-medium" x-text="t('menu.training')"></span>
                    </div>
                </div>
            </nav>

            <!-- –ö–Ω–æ–ø–∫–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∏ -->
            <div class="pt-3 border-t border-gray-100 mb-3">
                <a href="https://t.me/S_Shevil" target="_blank"
                   class="flex items-center p-3 rounded-xl bg-gradient-to-r from-blue-500 to-cyan-500 text-white hover:from-blue-600 hover:to-cyan-600 transition-all">
                    <i class="fab fa-telegram w-5"></i>
                    <span class="ml-3 font-medium">–ü–æ–¥–¥–µ—Ä–∂–∫–∞</span>
                </a>
            </div>

            <!-- Status -->
            <div class="pt-3 border-t border-gray-100">
                <div class="flex items-center">
                    <div class="status-dot mr-2"></div>
                    <span class="text-sm text-gray-600" x-text="t('messages.allSystemsActive')"></span>
                </div>
            </div>
        </aside>

        <!-- Main content -->
        <main class="flex-1 overflow-y-auto px-5 pt-2 pb-4">
            <!-- Loading indicator -->
            <div x-show="loading" class="fixed inset-0 bg-white/80 backdrop-blur-sm z-50 flex items-center justify-center">
                <div class="text-center">
                    <i class="fas fa-spinner fa-spin text-4xl text-indigo-500 mb-4"></i>
                    <div class="text-gray-600" x-text="t('common.loading')"></div>
                </div>
            </div>

            <!-- Connection error -->
            <div x-show="error" x-cloak class="glass rounded-2xl p-6 mb-6 border-l-4 border-red-500">
                <div class="flex items-center">
                    <i class="fas fa-exclamation-triangle text-red-500 mr-3"></i>
                    <div>
                        <div class="font-bold text-red-700" x-text="t('messages.connectionError')"></div>
                        <div class="text-sm text-gray-600" x-text="error"></div>
                    </div>
                    <button @click="loadAllData()" class="ml-auto px-5 py-2.5 bg-red-100 text-red-600 rounded-xl hover:bg-red-200 font-medium transition-all">
                        <i class="fas fa-redo mr-1"></i> <span x-text="t('messages.retry')"></span>
                    </button>
                </div>
            </div>

            <!-- Header -->
            <div class="flex items-center justify-between mb-3">
                <div>
                    <h2 class="text-xl font-bold" x-text="getPageTitle()"></h2>
                    <p class="text-sm text-gray-500" x-text="getPageSubtitle()"></p>
                </div>

                <div class="flex items-center space-x-3">
                    <!-- Balance (only for admins without "–º–æ–π –∞–¥–º–∏–Ω") -->
                    <template x-if="currentUser.role === 'admin' && !isRestricted">
                        <div class="glass px-4 py-2 rounded-xl flex items-center">
                            <i class="fas fa-wallet mr-2 text-gray-400"></i>
                            <span class="font-semibold" :class="userBalance > 0 ? 'text-green-600' : 'text-red-500'">
                                $<span x-text="userBalance.toFixed(2)"></span>
                            </span>
                        </div>
                    </template>

                    <!-- Profile -->
                    <div class="relative" x-data="{open: false}">
                        <button @click="open = !open" class="flex items-center glass px-4 py-2 rounded-xl hover:bg-gray-50">
                            <div class="w-8 h-8 rounded-full bg-gradient-to-r from-indigo-500 to-purple-500 flex items-center justify-center overflow-hidden">
                                <template x-if="currentUser.avatar_url">
                                    <img :src="currentUser.avatar_url" class="w-full h-full object-cover">
                                </template>
                                <template x-if="!currentUser.avatar_url">
                                    <span class="text-white text-sm font-medium" x-text="currentUser.username ? currentUser.username.substring(0,1).toUpperCase() : 'U'">U</span>
                                </template>
                            </div>
                            <span class="ml-2 text-sm font-medium hidden md:block" x-text="currentUser.username"></span>
                            <i class="fas fa-chevron-down ml-2 text-gray-400 text-xs"></i>
                        </button>

                        <div x-show="open" @click.outside="open = false" class="absolute right-0 mt-2 w-56 glass rounded-xl p-2 shadow-xl z-50">
                            <div class="px-3 py-2 border-b border-gray-100 mb-2">
                                <div class="font-medium" x-text="currentUser.username"></div>
                                <div class="text-xs text-gray-500" x-text="t('roles.' + currentUser.role)"></div>
                            </div>
                            <a href="#" @click.prevent="showSettingsModal = true; open = false" class="flex items-center p-3 rounded-lg hover:bg-gray-100 text-gray-700 mb-1">
                                <i class="fas fa-cog mr-3"></i>
                                <span>–ù–∞—Å—Ç—Ä–æ–π–∫–∏</span>
                            </a>
                            <a href="#" @click="logout()" class="flex items-center p-3 rounded-lg hover:bg-red-50 text-red-500">
                                <i class="fas fa-sign-out-alt mr-3"></i>
                                <span x-text="t('userMenu.logout')"></span>
                            </a>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Content -->
            <!-- Statistics -->
            <div x-show="activeMenu === 'stats'" class="fade-in">
                <!-- Filters -->
                <div class="glass rounded-2xl p-5 mb-6">
                    <div class="flex items-center gap-4 flex-wrap">
                        <!-- Admin filter (—Ç–æ–ª—å–∫–æ –¥–ª—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∞) -->
                        <div x-show="currentUser.role === 'director'">
                            <select class="glass px-4 py-2.5 rounded-xl" x-model="statsFilter.admin" @change="statsFilter.translator = ''">
                                <option value="" x-text="t('filters.allAdmins')"></option>
                                <template x-for="admin in admins" :key="admin.id">
                                    <option :value="admin.id" x-text="admin.name"></option>
                                </template>
                            </select>
                        </div>

                        <!-- Translator filter (–¥–ª—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∞ - –ø—Ä–∏ –≤—ã–±–æ—Ä–µ –∞–¥–º–∏–Ω–∞, –¥–ª—è –∞–¥–º–∏–Ω–∞ - –≤—Å–µ–≥–¥–∞) -->
                        <div x-show="currentUser.role === 'admin' || statsFilter.admin">
                            <select class="glass px-4 py-2.5 rounded-xl" x-model="statsFilter.translator">
                                <option value="" x-text="t('filters.allTranslators')"></option>
                                <template x-for="translator in (currentUser.role === 'admin' ? myTranslators : (admins.find(a => a.id == statsFilter.admin)?.translators || []))" :key="translator.id">
                                    <option :value="translator.id" x-text="translator.name"></option>
                                </template>
                            </select>
                        </div>

                        <!-- –ö–∞–ª–µ–Ω–¥–∞—Ä—å –≤—ã–±–æ—Ä–∞ –¥–∏–∞–ø–∞–∑–æ–Ω–∞ (Flatpickr) -->
                        <div class="flex items-center gap-2">
                            <div class="glass px-4 py-2.5 rounded-xl flex items-center">
                                <i class="fas fa-calendar mr-2 text-gray-400"></i>
                                <input type="text" id="statsDatePicker" class="bg-transparent border-none outline-none w-48 text-sm" readonly :placeholder="t('common.selectPeriod')">
                            </div>
                            <div class="flex gap-1">
                                <button @click="setQuickDateRange('month')" class="px-3 py-2 rounded-lg text-sm" :class="statsFilter.quickRange === 'month' ? 'bg-indigo-500 text-white' : 'glass hover:bg-gray-100'" x-text="t('common.month')"></button>
                                <button @click="setQuickDateRange('week')" class="px-3 py-2 rounded-lg text-sm" :class="statsFilter.quickRange === 'week' ? 'bg-indigo-500 text-white' : 'glass hover:bg-gray-100'" x-text="t('common.week')"></button>
                                <button @click="setQuickDateRange('today')" class="px-3 py-2 rounded-lg text-sm" :class="statsFilter.quickRange === 'today' ? 'bg-indigo-500 text-white' : 'glass hover:bg-gray-100'" x-text="t('common.today')"></button>
                            </div>
                        </div>

                        <div class="ml-auto flex gap-2">
                            <button @click="refreshAllStats()" class="w-9 h-9 rounded-lg bg-indigo-500 text-white hover:bg-indigo-600 flex items-center justify-center" :class="{'opacity-50 cursor-wait': loading}" :title="t('common.refresh')">
                                <i class="fas fa-sync-alt text-sm" :class="{'fa-spin': loading}"></i>
                            </button>
                            <button @click="exportStats()" class="w-9 h-9 rounded-lg bg-green-500 text-white hover:bg-green-600 flex items-center justify-center" :title="t('common.export')">
                                <i class="fas fa-download text-sm"></i>
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Stats cards - 5 –±–ª–æ–∫–æ–≤ -->
                <div class="grid grid-cols-5 gap-4 mb-8">
                    <!-- 1. –û–Ω–ª–∞–π–Ω -->
                    <div class="glass rounded-2xl p-5 cursor-pointer flex flex-col justify-center items-center h-28" @click="setActiveMenu('accounts')">
                        <div class="w-10 h-10 rounded-xl bg-gradient-to-r from-blue-50 to-blue-100 flex items-center justify-center mb-2">
                            <i class="fas fa-user text-blue-500"></i>
                        </div>
                        <div class="text-3xl font-bold"><span class="text-green-500" x-text="stats.metrics.profilesOnline || 0"></span><span class="text-gray-800">/</span><span class="text-gray-800" x-text="stats.metrics.totalProfiles"></span></div>
                        <div class="text-xs text-gray-500 mt-1">–û–Ω–ª–∞–π–Ω</div>
                    </div>

                    <!-- 2. –í—Ö–æ–¥—è—â–∏–µ –ø–∏—Å—å–º–∞ -->
                    <div class="glass rounded-2xl p-5 flex flex-col justify-center items-center h-28">
                        <div class="w-10 h-10 rounded-xl bg-gradient-to-r from-purple-50 to-purple-100 flex items-center justify-center mb-2">
                            <i class="fas fa-envelope-open text-purple-500"></i>
                        </div>
                        <div class="text-3xl font-bold text-gray-800" x-text="stats.incomingLetters || stats.today.incomingLetters || 0">0</div>
                        <div class="text-xs text-gray-500 mt-1">–í—Ö–æ–¥—è—â–∏—Ö –ø–∏—Å–µ–º</div>
                    </div>

                    <!-- 3. –í—Ö–æ–¥—è—â–∏–µ —á–∞—Ç—ã -->
                    <div class="glass rounded-2xl p-5 flex flex-col justify-center items-center h-28">
                        <div class="w-10 h-10 rounded-xl bg-gradient-to-r from-green-50 to-green-100 flex items-center justify-center mb-2">
                            <i class="fas fa-comments text-green-500"></i>
                        </div>
                        <div class="flex items-center gap-2">
                            <div class="text-center">
                                <div class="text-3xl font-bold text-green-600" x-text="stats.incomingChatsAnswered || 0">0</div>
                                <div class="text-[10px] text-gray-500">–û—Ç–≤–µ—á–µ–Ω–Ω—ã–µ</div>
                            </div>
                            <div class="text-3xl font-bold text-gray-400">|</div>
                            <div class="text-center">
                                <div class="text-3xl font-bold text-gray-800" x-text="stats.incomingChatsTotal || 0">0</div>
                                <div class="text-[10px] text-gray-500">–í—Å–µ–≥–æ</div>
                            </div>
                        </div>
                        <div class="text-xs text-gray-500 mt-1">–í—Ö–æ–¥—è—â–∏—Ö —á–∞—Ç–æ–≤</div>
                    </div>

                    <!-- 4. –ú–µ–¥–∏–∞–Ω–Ω–æ–µ –≤—Ä–µ–º—è -->
                    <div class="glass rounded-2xl p-5 flex flex-col justify-center items-center h-28">
                        <div class="w-10 h-10 rounded-xl bg-gradient-to-r from-orange-50 to-orange-100 flex items-center justify-center mb-2">
                            <i class="fas fa-stopwatch text-orange-500"></i>
                        </div>
                        <div class="text-3xl font-bold text-gray-800" x-text="stats.metrics.medianResponseTime || 0">0</div>
                        <div class="text-xs text-gray-500 mt-1">–ú–µ–¥–∏–∞–Ω–Ω–æ–µ –≤—Ä–µ–º—è</div>
                    </div>

                    <!-- 5. –£–Ω–∏–∫–∞–ª—å–Ω—ã–µ –º—É–∂—á–∏–Ω—ã -->
                    <div class="glass rounded-2xl p-5 flex flex-col justify-center items-center h-28">
                        <div class="w-10 h-10 rounded-xl bg-gradient-to-r from-indigo-50 to-indigo-100 flex items-center justify-center mb-2">
                            <i class="fas fa-mars text-indigo-500"></i>
                        </div>
                        <div class="flex items-center gap-2">
                            <div class="text-center">
                                <div class="text-3xl font-bold text-gray-800" x-text="stats.uniqueMenLetters || 0">0</div>
                                <div class="text-[10px] text-gray-500">–ü–∏—Å—å–º–∞</div>
                            </div>
                            <div class="text-3xl font-bold text-gray-400">|</div>
                            <div class="text-center">
                                <div class="text-3xl font-bold text-gray-800" x-text="stats.uniqueMenChats || 0">0</div>
                                <div class="text-[10px] text-gray-500">–ß–∞—Ç—ã</div>
                            </div>
                        </div>
                        <div class="text-xs text-gray-500 mt-1">–£–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –º—É–∂—á–∏–Ω</div>
                    </div>
                </div>

                <!-- Bots and work time -->
                <div class="grid gap-6 mb-8" :class="currentUser.role === 'translator' ? 'grid-cols-1' : 'grid-cols-2'">
                    <!-- –°—Ç–∞—Ç—É—Å –±–æ—Ç–æ–≤ (–ø—Ä–æ–≥—Ä–∞–º–º) - —Ç–æ–ª—å–∫–æ –¥–ª—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∞ -->
                    <div x-show="currentUser.role === 'director'" class="glass rounded-2xl p-6">
                        <h3 class="text-lg font-bold mb-4">–°—Ç–∞—Ç—É—Å –±–æ—Ç–æ–≤</h3>
                        <div class="text-3xl font-bold leading-tight mb-3" :class="botsStatus.online > 0 ? 'text-green-600' : 'text-gray-400'" x-text="botsStatus.online || 0">0</div>
                        <div class="text-sm text-gray-500 flex gap-3 flex-wrap">
                            <span class="text-green-600">Online: <span x-text="botsStatus.online || 0"></span></span>
                            <span class="text-gray-500">Offline: <span x-text="botsStatus.offline || 0"></span></span>
                        </div>
                    </div>

                    <div class="glass rounded-2xl p-6">
                        <h3 class="text-lg font-bold mb-4" x-text="t('stats.workTime')"></h3>
                        <div class="text-3xl font-bold leading-tight mb-3 text-purple-600" x-text="stats.metrics.workTime || '0—á 0–º'"></div>
                        <div class="text-sm text-gray-500"><span x-text="t('stats.forMonth')"></span>: <span x-text="stats.metrics.workTimeMonth || '0—á 0–º'"></span></div>
                    </div>
                </div>

                <!-- –î–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –±–æ—Ç–∞—Ö - —Ç–æ–ª—å–∫–æ –¥–ª—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∞ -->
                <div x-show="currentUser.role === 'director' && bots.length > 0" class="glass rounded-2xl p-6 mb-8">
                    <div class="flex items-center justify-between mb-4">
                        <h3 class="text-lg font-bold">–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –±–æ—Ç–æ–≤</h3>
                        <button @click="loadBotsStatus()" class="text-sm text-indigo-600 hover:text-indigo-800">
                            <i class="fas fa-sync-alt mr-1"></i>–û–±–Ω–æ–≤–∏—Ç—å
                        </button>
                    </div>
                    <div class="overflow-x-auto">
                        <table class="w-full">
                            <thead>
                                <tr class="border-b border-gray-100 text-xs text-gray-500 uppercase">
                                    <th class="text-left py-3 px-4">–ë–æ—Ç</th>
                                    <th class="text-left py-3 px-4">–°—Ç–∞—Ç—É—Å</th>
                                    <th class="text-left py-3 px-4">IP</th>
                                    <th class="text-left py-3 px-4">–ê–Ω–∫–µ—Ç</th>
                                    <th class="text-left py-3 px-4">–í–µ—Ä—Å–∏—è</th>
                                    <th class="text-left py-3 px-4">–ü–æ—Å–ª–µ–¥–Ω—è—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å</th>
                                </tr>
                            </thead>
                            <tbody>
                                <template x-for="bot in bots" :key="bot.id">
                                    <tr class="border-b border-gray-50 hover:bg-gray-50">
                                        <td class="py-3 px-4">
                                            <div class="flex items-center">
                                                <i :class="bot.icon || 'fas fa-robot'" class="mr-2 text-gray-400"></i>
                                                <span class="font-medium" x-text="bot.name || bot.id"></span>
                                            </div>
                                        </td>
                                        <td class="py-3 px-4">
                                            <span class="px-2 py-1 rounded-full text-xs font-medium"
                                                  :class="{
                                                      'bg-green-100 text-green-700': bot.status === 'online' || bot.status === 'active',
                                                      'bg-yellow-100 text-yellow-700': bot.status === 'idle',
                                                      'bg-red-100 text-red-700': bot.status === 'offline' || bot.status === 'error',
                                                      'bg-gray-100 text-gray-700': bot.status === 'never_connected'
                                                  }"
                                                  x-text="bot.status === 'online' || bot.status === 'active' ? 'Online' :
                                                          bot.status === 'idle' ? 'Idle' :
                                                          bot.status === 'error' ? 'Error' :
                                                          bot.status === 'never_connected' ? '–ù–µ –ø–æ–¥–∫–ª—é—á–∞–ª—Å—è' : 'Offline'">
                                            </span>
                                        </td>
                                        <td class="py-3 px-4 font-mono text-sm text-gray-500" x-text="bot.ip || '-'"></td>
                                        <td class="py-3 px-4" x-text="bot.profilesCount || 0"></td>
                                        <td class="py-3 px-4 text-sm text-gray-500" x-text="bot.version || '-'"></td>
                                        <td class="py-3 px-4 text-sm text-gray-500" x-text="bot.lastHeartbeat ? new Date(bot.lastHeartbeat).toLocaleString('ru-RU') : '-'"></td>
                                    </tr>
                                </template>
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- –ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å -->
                <div class="glass rounded-2xl p-6">
                    <div class="flex justify-between items-center mb-4">
                        <h3 class="text-lg font-bold" x-text="t('stats.peakHours')"></h3>
                        <button @click="alert('–≠—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è –ø–æ–∫–∞ –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ')" class="text-sm text-indigo-600 hover:text-indigo-800" x-text="t('stats.advancedStats') + ' ‚Üí'">
                        </button>
                    </div>
                    <div class="flex items-end h-20 gap-1">
                        <template x-for="hour in 24" :key="hour">
                            <div class="flex-1 rounded-t transition-all bg-gradient-to-t"
                                 :class="getActivityColor(hour-1)"
                                 :style="'height:' + Math.max(getActivityLevel(hour-1) * 100, 8) + '%'"
                                 :title="(hour-1) + ':00 - –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å ' + Math.round(getActivityLevel(hour-1) * 100) + '%'">
                            </div>
                        </template>
                    </div>
                    <div class="flex justify-between text-[10px] text-gray-400 mt-1">
                        <span>0—á</span>
                        <span>6—á</span>
                        <span>12—á</span>
                        <span>18—á</span>
                        <span>23—á</span>
                    </div>
                </div>
                
                <!-- –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø–µ—Ä–µ–≤–æ–¥—á–∏–∫–æ–≤ (–µ—Å–ª–∏ –≤—ã–±—Ä–∞–Ω –∞–¥–º–∏–Ω) -->
                <div x-show="statsFilter.admin && activeSubmenu === 'admins'" class="glass rounded-2xl p-6 mt-6 fade-in">
                    <h3 class="text-lg font-bold mb-6" x-text="t('stats.compareTranslators')"></h3>
                    <div class="overflow-x-auto">
                        <table class="w-full">
                            <thead>
                                <tr class="border-b border-gray-100">
                                    <th class="text-left py-4 px-6" x-text="t('roles.translator')"></th>
                                    <th class="text-left py-4 px-6" x-text="t('stats.letters')"></th>
                                    <th class="text-left py-4 px-6" x-text="t('stats.chats')"></th>
                                    <th class="text-left py-4 px-6" x-text="t('stats.avgTime')"></th>
                                </tr>
                            </thead>
                            <tbody>
                                <template x-for="translator in translatorStats" :key="translator.id">
                                    <tr class="border-b border-gray-100 hover:bg-gray-50">
                                        <td class="py-4 px-6" x-text="translator.username"></td>
                                        <td class="py-4 px-6" x-text="translator.letters"></td>
                                        <td class="py-4 px-6" x-text="translator.chats"></td>
                                        <td class="py-4 px-6" x-text="translator.avgResponseTime + ' –º–∏–Ω'"></td>
                                    </tr>
                                </template>
                                <tr x-show="translatorStats.length === 0">
                                    <td colspan="4" class="py-4 px-6 text-center text-gray-500" x-text="t('common.noData')"></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- –î–µ—Ç–∞–ª—å–Ω–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å -->
                <div class="glass rounded-2xl p-6 mt-8">
                    <h3 class="text-lg font-bold mb-6">üìä –î–µ—Ç–∞–ª—å–Ω–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å</h3>

                    <!-- –§—É–Ω–∫—Ü–∏–∏ -->
                    <div class="grid grid-cols-2 md:grid-cols-4 gap-3 mb-6">
                        <button @click="setMonitoringFunction('lastResponses')"
                                class="glass p-4 rounded-xl text-center hover:bg-gray-50 transition-all"
                                :class="monitoringFunction === 'lastResponses' ? 'bg-indigo-50 border-2 border-indigo-300 shadow-md' : ''">
                            <i class="fas fa-comments text-blue-500 text-2xl mb-2 block"></i>
                            <div class="font-medium text-sm" x-text="t('monitoring.lastResponses')"></div>
                        </button>

                        <button @click="setMonitoringFunction('sentLetters')"
                                class="glass p-4 rounded-xl text-center hover:bg-gray-50 transition-all"
                                :class="monitoringFunction === 'sentLetters' ? 'bg-indigo-50 border-2 border-indigo-300 shadow-md' : ''">
                            <i class="fas fa-paper-plane text-green-500 text-2xl mb-2 block"></i>
                            <div class="font-medium text-sm" x-text="t('monitoring.sentLetters')"></div>
                        </button>

                        <button @click="setMonitoringFunction('favoriteMailing')"
                                class="glass p-4 rounded-xl text-center hover:bg-gray-50 transition-all"
                                :class="monitoringFunction === 'favoriteMailing' ? 'bg-indigo-50 border-2 border-indigo-300 shadow-md' : ''">
                            <i class="fas fa-heart text-red-500 text-2xl mb-2 block"></i>
                            <div class="font-medium text-sm" x-text="t('monitoring.favoriteMailing')"></div>
                        </button>

                        <button @click="setMonitoringFunction('aiUsage')"
                                class="glass p-4 rounded-xl text-center hover:bg-gray-50 transition-all"
                                :class="monitoringFunction === 'aiUsage' ? 'bg-indigo-50 border-2 border-indigo-300 shadow-md' : ''">
                            <i class="fas fa-brain text-orange-500 text-2xl mb-2 block"></i>
                            <div class="font-medium text-sm" x-text="t('monitoring.aiUsage')"></div>
                        </button>
                    </div>

                    <!-- –ö–æ–Ω—Ç–µ–Ω—Ç –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ -->
                    <div class="glass rounded-2xl p-6 border border-gray-100">
                        <h4 class="text-md font-bold mb-4" x-text="getMonitoringTitle()"></h4>

                        <!-- –ü–æ—Å–ª–µ–¥–Ω–∏–µ –æ—Ç–≤–µ—Ç—ã -->
                        <div x-show="monitoringFunction === 'lastResponses'" x-transition class="space-y-3">
                            <!-- –ö–Ω–æ–ø–∫–∞ —ç–∫—Å–ø–æ—Ä—Ç–∞ -->
                            <div class="flex justify-end mb-2" x-show="recentActivity.filter(a => (a.action_type === 'chat' || a.action_type === 'letter') && a.is_reply).length > 0">
                                <button @click="exportLastResponses()" class="px-3 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 font-medium transition-all text-xs">
                                    <i class="fas fa-download mr-1"></i>–í—ã–≥—Ä—É–∑–∏—Ç—å
                                </button>
                            </div>
                            <template x-for="activity in recentActivity.filter(a => (a.action_type === 'chat' || a.action_type === 'letter') && a.is_reply).slice(0, showAllResponses ? undefined : 5)" :key="activity.id">
                                <div class="p-3 rounded-xl border border-gray-100 bg-blue-50 hover:bg-blue-100 transition-colors">
                                    <div class="font-medium mb-2">
                                        <span class="text-blue-600">‚Ü©Ô∏è –û—Ç–≤–µ—Ç</span> | –ê–Ω–∫–µ—Ç–∞ <span x-text="activity.profile_id"></span> ‚Üí
                                        –ú—É–∂—á–∏–Ω–∞ <span x-text="activity.man_id"></span>
                                    </div>
                                    <div class="space-y-2 text-sm">
                                        <div class="bg-white p-2 rounded-lg">
                                            <span class="font-medium text-blue-600">–û—Ç–≤–µ—Ç:</span>
                                            <span x-text="activity.message_text || '(—Ç–µ–∫—Å—Ç –Ω–µ —Å–æ—Ö—Ä–∞–Ω—ë–Ω)'"></span>
                                        </div>
                                    </div>
                                    <div class="text-xs text-gray-400 mt-2" x-text="formatActivityTime(activity.created_at)"></div>
                                </div>
                            </template>
                            <div x-show="recentActivity.filter(a => (a.action_type === 'chat' || a.action_type === 'letter') && a.is_reply).length === 0" class="text-center text-gray-500 py-8">
                                –ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –æ–± –æ—Ç–≤–µ—Ç–∞—Ö
                            </div>
                            <!-- –ö–Ω–æ–ø–∫–∞ –ü–æ–∫–∞–∑–∞—Ç—å –µ—â–µ -->
                            <div x-show="recentActivity.filter(a => (a.action_type === 'chat' || a.action_type === 'letter') && a.is_reply).length > 5" class="text-center mt-3">
                                <button @click="showAllResponses = !showAllResponses" class="px-4 py-2 text-sm text-blue-600 hover:text-blue-800 font-medium">
                                    <span x-show="!showAllResponses">–ü–æ–∫–∞–∑–∞—Ç—å –µ—â–µ (<span x-text="recentActivity.filter(a => (a.action_type === 'chat' || a.action_type === 'letter') && a.is_reply).length - 5"></span>)</span>
                                    <span x-show="showAllResponses">–°–≤–µ—Ä–Ω—É—Ç—å</span>
                                </button>
                            </div>
                        </div>

                        <!-- –û—Ç–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ –ø–∏—Å—å–º–∞ -->
                        <div x-show="monitoringFunction === 'sentLetters'" x-transition class="space-y-3">
                            <!-- –ö–Ω–æ–ø–∫–∞ —ç–∫—Å–ø–æ—Ä—Ç–∞ -->
                            <div class="flex justify-end mb-2" x-show="sentLettersGrouped.length > 0">
                                <button @click="exportSentLettersGrouped()" class="px-3 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 font-medium transition-all text-xs">
                                    <i class="fas fa-download mr-1"></i>–í—ã–≥—Ä—É–∑–∏—Ç—å
                                </button>
                            </div>
                            <template x-for="letter in sentLettersGrouped.slice(0, showAllLetters ? undefined : 5)" :key="letter.profileId + '_' + letter.messageText">
                                <div class="flex flex-col p-4 rounded-xl border border-gray-100 hover:bg-gray-50 transition-colors">
                                    <div class="flex items-center mb-2">
                                        <i class="fas fa-envelope text-green-500 mr-2"></i>
                                        <span class="font-bold text-gray-800" x-text="'–ê–Ω–∫–µ—Ç–∞ ' + letter.profileId"></span>
                                    </div>
                                    <div class="text-sm text-gray-700 bg-gray-50 p-3 rounded-lg mb-2 whitespace-pre-wrap" x-text="letter.messageText"></div>
                                    <div class="flex items-center justify-between text-xs">
                                        <span class="text-green-600 font-medium" x-text="letter.sentCount + ' –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã—Ö'"></span>
                                        <span class="text-gray-400" x-text="formatActivityTime(letter.lastSentAt)"></span>
                                    </div>
                                </div>
                            </template>
                            <div x-show="sentLettersGrouped.length === 0" class="text-center text-gray-500 py-8">
                                –ù–µ—Ç –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã—Ö –ø–∏—Å–µ–º –∑–∞ –≤—ã–±—Ä–∞–Ω–Ω—ã–π –ø–µ—Ä–∏–æ–¥
                            </div>
                            <!-- –ö–Ω–æ–ø–∫–∞ –ü–æ–∫–∞–∑–∞—Ç—å –µ—â–µ -->
                            <div x-show="sentLettersGrouped.length > 5" class="text-center mt-3">
                                <button @click="showAllLetters = !showAllLetters" class="px-4 py-2 text-sm text-green-600 hover:text-green-800 font-medium">
                                    <span x-show="!showAllLetters">–ü–æ–∫–∞–∑–∞—Ç—å –µ—â–µ (<span x-text="sentLettersGrouped.length - 5"></span>)</span>
                                    <span x-show="showAllLetters">–°–≤–µ—Ä–Ω—É—Ç—å</span>
                                </button>
                            </div>
                        </div>

                        <!-- –õ—é–±–∏–º–∞—è —Ä–∞—Å—Å—ã–ª–∫–∞ -->
                        <div x-show="monitoringFunction === 'favoriteMailing'" x-transition class="space-y-3">
                            <!-- –ö–Ω–æ–ø–∫–∞ —ç–∫—Å–ø–æ—Ä—Ç–∞ (–º–µ–Ω—å—à–µ) -->
                            <div class="flex justify-end mb-2" x-show="favoriteTemplates.length > 0">
                                <button @click="exportFavoriteTemplates()" class="px-3 py-2 bg-pink-500 text-white rounded-lg hover:bg-pink-600 font-medium transition-all text-xs">
                                    <i class="fas fa-download mr-1"></i>–í—ã–≥—Ä—É–∑–∏—Ç—å
                                </button>
                            </div>
                            <div class="space-y-3">
                                <template x-for="template in favoriteTemplates.slice(0, showAllTemplates ? undefined : 3)" :key="template.id">
                                    <div class="p-4 rounded-xl bg-gradient-to-r from-pink-50 to-rose-50 border border-pink-200 hover:shadow-md transition-shadow">
                                        <div class="flex items-center mb-2">
                                            <i class="fas fa-heart text-red-500 mr-2"></i>
                                            <span class="font-medium" x-text="template.templateName || '–ë–µ–∑ –Ω–∞–∑–≤–∞–Ω–∏—è'"></span>
                                            <span class="ml-auto text-xs text-gray-500">
                                                –ê–Ω–∫–µ—Ç–∞: <span x-text="template.profileLogin || template.profileId"></span>
                                            </span>
                                        </div>
                                        <div class="text-sm text-gray-700 bg-white p-3 rounded-lg border border-pink-100 whitespace-pre-wrap" x-text="template.templateText || '(—Ç–µ–∫—Å—Ç –Ω–µ —Å–æ—Ö—Ä–∞–Ω—ë–Ω)'"></div>
                                        <div class="text-xs text-gray-400 mt-2" x-text="new Date(template.createdAt).toLocaleString('ru-RU')"></div>
                                    </div>
                                </template>
                            </div>
                            <div x-show="favoriteTemplates.length === 0" class="text-center text-gray-500 py-8">
                                <i class="fas fa-heart text-gray-300 text-4xl mb-3 block"></i>
                                –ù–µ—Ç –∏–∑–±—Ä–∞–Ω–Ω—ã—Ö —à–∞–±–ª–æ–Ω–æ–≤. –û—Ç–º–µ—Ç—å—Ç–µ —à–∞–±–ª–æ–Ω —Å–µ—Ä–¥–µ—á–∫–æ–º –≤ –±–æ—Ç–µ.
                            </div>
                            <!-- –ö–Ω–æ–ø–∫–∞ –ü–æ–∫–∞–∑–∞—Ç—å –µ—â–µ -->
                            <div x-show="favoriteTemplates.length > 3" class="text-center mt-3">
                                <button @click="showAllTemplates = !showAllTemplates" class="px-4 py-2 text-sm text-pink-600 hover:text-pink-800 font-medium">
                                    <span x-show="!showAllTemplates">–ü–æ–∫–∞–∑–∞—Ç—å –µ—â–µ (<span x-text="favoriteTemplates.length - 3"></span>)</span>
                                    <span x-show="showAllTemplates">–°–≤–µ—Ä–Ω—É—Ç—å</span>
                                </button>
                            </div>
                        </div>

                        <!-- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ò–ò -->
                        <div x-show="monitoringFunction === 'aiUsage'" x-transition class="space-y-4">
                            <!-- –ö–Ω–æ–ø–∫–∞ —ç–∫—Å–ø–æ—Ä—Ç–∞ -->
                            <div class="flex justify-end mb-2" x-show="recentActivity.filter(a => a.used_ai).length > 0">
                                <button @click="exportAiUsage()" class="px-3 py-2 bg-orange-500 text-white rounded-lg hover:bg-orange-600 font-medium transition-all text-xs">
                                    <i class="fas fa-download mr-1"></i>–í—ã–≥—Ä—É–∑–∏—Ç—å
                                </button>
                            </div>
                            <div class="glass p-4 rounded-xl">
                                <div class="flex justify-between items-center mb-2">
                                    <div class="font-medium" x-text="t('monitoring.aiGenerations')"></div>
                                    <div class="text-2xl font-bold text-orange-600" x-text="recentActivity.filter(a => a.used_ai).length"></div>
                                </div>
                                <div class="text-sm text-gray-600" x-text="t('monitoring.recentGenerations')"></div>
                            </div>
                            <div class="glass p-4 rounded-xl">
                                <div class="font-medium mb-2">–ü–æ—Å–ª–µ–¥–Ω–∏–µ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏:</div>
                                <div class="space-y-2 text-sm">
                                    <template x-for="activity in recentActivity.filter(a => a.used_ai).slice(0, showAllAiUsage ? undefined : 5)" :key="activity.id">
                                        <div class="border-l-4 border-orange-400 pl-3 py-2 bg-orange-50 rounded-r hover:bg-orange-100 transition-colors">
                                            <div x-text="activity.message_text ? activity.message_text.substring(0, 150) + '...' : '(–ò–ò –≥–µ–Ω–µ—Ä–∞—Ü–∏—è)'"></div>
                                            <div class="text-xs text-gray-500 mt-1" x-text="formatActivityTime(activity.created_at)"></div>
                                        </div>
                                    </template>
                                    <div x-show="recentActivity.filter(a => a.used_ai).length === 0" class="text-center text-gray-500 py-4">
                                        –ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –æ–± –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ –ò–ò
                                    </div>
                                </div>
                            </div>
                            <!-- –ö–Ω–æ–ø–∫–∞ –ü–æ–∫–∞–∑–∞—Ç—å –µ—â–µ -->
                            <div x-show="recentActivity.filter(a => a.used_ai).length > 5" class="text-center mt-3">
                                <button @click="showAllAiUsage = !showAllAiUsage" class="px-4 py-2 text-sm text-orange-600 hover:text-orange-800 font-medium">
                                    <span x-show="!showAllAiUsage">–ü–æ–∫–∞–∑–∞—Ç—å –µ—â–µ (<span x-text="recentActivity.filter(a => a.used_ai).length - 5"></span>)</span>
                                    <span x-show="showAllAiUsage">–°–≤–µ—Ä–Ω—É—Ç—å</span>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- –ö–æ–º–∞–Ω–¥–∞ -->
            <div x-show="activeMenu === 'team'" x-cloak class="fade-in">
                <!-- –î–ª—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∞ -->
                <template x-if="currentUser.role === 'director'">
                    <div>
                        <!-- –°–µ–∫—Ü–∏—è –ê–¥–º–∏–Ω—ã -->
                        <div class="glass rounded-2xl p-5 mb-6">
                            <div class="flex justify-between items-center mb-4">
                                <h3 class="text-lg font-bold">
                                    <i class="fas fa-user-tie text-indigo-500 mr-2"></i>–ê–¥–º–∏–Ω—ã
                                </h3>
                                <button @click="showAddAdminModal = true" class="px-4 py-2 rounded-xl text-sm font-medium bg-gradient-to-r from-indigo-500 to-purple-500 hover:from-indigo-600 hover:to-purple-600 text-white transition-all">
                                    <i class="fas fa-plus mr-2"></i>–î–æ–±–∞–≤–∏—Ç—å –∞–¥–º–∏–Ω–∞
                                </button>
                            </div>

                            <div class="space-y-3">
                                <template x-for="admin in admins" :key="admin.id">
                                    <div class="border border-gray-200 rounded-xl overflow-hidden">
                                        <!-- –ö–∞—Ä—Ç–æ—á–∫–∞ –∞–¥–º–∏–Ω–∞ -->
                                        <div class="bg-gradient-to-r from-blue-50 to-indigo-50 p-4 flex items-center justify-between cursor-pointer hover:from-blue-100 hover:to-indigo-100 transition-colors"
                                             @click="toggleAdminExpanded(admin.id)">
                                            <div class="flex items-center">
                                                <div class="w-12 h-12 rounded-full bg-gradient-to-r from-blue-500 to-indigo-500 flex items-center justify-center flex-shrink-0">
                                                    <span class="text-white font-bold" x-text="admin.initials"></span>
                                                </div>
                                                <div class="ml-4">
                                                    <div class="font-semibold text-gray-800" x-text="admin.name"></div>
                                                    <div class="text-sm text-gray-500">
                                                        <span x-text="admin.translators.length"></span> –ø–µ—Ä–µ–≤–æ–¥—á–∏–∫–æ–≤ ‚Ä¢
                                                        <span x-text="admin.accounts"></span> –∞–Ω–∫–µ—Ç
                                                    </div>
                                                </div>
                                            </div>

                                            <div class="flex items-center gap-2">
                                                <!-- –ú–æ–π –∞–¥–º–∏–Ω -->
                                                <label class="flex items-center gap-2 px-3 py-1.5 rounded-lg bg-white/50 cursor-pointer" @click.stop>
                                                    <input type="checkbox" :checked="admin.isMyAdmin" @change="toggleIsRestricted(admin)" class="w-4 h-4 text-indigo-600 rounded">
                                                    <span class="text-sm text-gray-600">–ú–æ–π –∞–¥–º–∏–Ω</span>
                                                </label>

                                                <!-- AI toggle -->
                                                <label class="flex items-center gap-2 px-3 py-1.5 rounded-lg bg-white/50 cursor-pointer" @click.stop>
                                                    <input type="checkbox" :checked="admin.aiEnabled" @change="toggleAiEnabled(admin)" class="w-4 h-4 text-purple-600 rounded">
                                                    <span class="text-sm text-gray-600">AI</span>
                                                </label>

                                                <!-- –ü–æ–ø–æ–ª–Ω–∏—Ç—å –±–∞–ª–∞–Ω—Å (–µ—Å–ª–∏ –Ω–µ –º–æ–π –∞–¥–º–∏–Ω) -->
                                                <button x-show="!admin.isMyAdmin" @click.stop="openTopupModal(admin.id)"
                                                        class="w-9 h-9 rounded-lg bg-green-100 hover:bg-green-200 flex items-center justify-center"
                                                        title="–ü–æ–ø–æ–ª–Ω–∏—Ç—å –±–∞–ª–∞–Ω—Å">
                                                    <i class="fas fa-dollar-sign text-green-600"></i>
                                                </button>

                                                <!-- –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å -->
                                                <button @click.stop="editAdmin(admin)"
                                                        class="w-9 h-9 rounded-lg bg-blue-100 hover:bg-blue-200 flex items-center justify-center"
                                                        title="–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å">
                                                    <i class="fas fa-edit text-blue-600"></i>
                                                </button>

                                                <!-- –£–¥–∞–ª–∏—Ç—å -->
                                                <button @click.stop="deleteAdmin(admin)"
                                                        class="w-9 h-9 rounded-lg bg-red-100 hover:bg-red-200 flex items-center justify-center"
                                                        title="–£–¥–∞–ª–∏—Ç—å">
                                                    <i class="fas fa-trash text-red-600"></i>
                                                </button>

                                                <!-- –°—Ç—Ä–µ–ª–∫–∞ —Ä–∞—Å–∫—Ä—ã—Ç–∏—è -->
                                                <div class="w-9 h-9 flex items-center justify-center">
                                                    <i class="fas fa-chevron-down text-gray-400 transition-transform" :class="expandedAdminId === admin.id ? 'rotate-180' : ''"></i>
                                                </div>
                                            </div>
                                        </div>

                                        <!-- –ü–µ—Ä–µ–≤–æ–¥—á–∏–∫–∏ –∞–¥–º–∏–Ω–∞ (—Ä–∞—Å–∫—Ä—ã–≤–∞—é—â–∏–π—Å—è —Å–ø–∏—Å–æ–∫) -->
                                        <div x-show="expandedAdminId === admin.id" x-transition class="bg-gray-50 p-4 border-t border-gray-200">
                                            <div x-show="admin.translators.length === 0" class="text-center text-gray-500 py-4">
                                                <i class="fas fa-users text-gray-300 text-2xl mb-2"></i>
                                                <div>–ù–µ—Ç –ø–µ—Ä–µ–≤–æ–¥—á–∏–∫–æ–≤</div>
                                            </div>
                                            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3">
                                                <template x-for="translator in admin.translators" :key="translator.id">
                                                    <div class="bg-white rounded-lg p-3 border border-gray-200 flex items-center justify-between">
                                                        <div class="flex items-center">
                                                            <div class="w-10 h-10 rounded-full bg-gradient-to-r from-purple-500 to-pink-500 flex items-center justify-center">
                                                                <span class="text-white font-medium" x-text="translator.name.charAt(0).toUpperCase()"></span>
                                                            </div>
                                                            <div class="ml-3">
                                                                <div class="font-medium text-gray-800" x-text="translator.name"></div>
                                                                <div class="text-xs text-gray-500"><span x-text="translator.accountsCount || 0"></span> –∞–Ω–∫–µ—Ç</div>
                                                            </div>
                                                        </div>
                                                        <div class="flex items-center gap-1">
                                                            <!-- AI toggle (—Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ —É –∞–¥–º–∏–Ω–∞ –≤–∫–ª—é—á–µ–Ω AI) -->
                                                            <label x-show="admin.aiEnabled" class="flex items-center gap-1 px-2 py-1 rounded bg-gray-50 cursor-pointer" @click.stop>
                                                                <input type="checkbox" :checked="translator.aiEnabled" @change="toggleAiEnabled(translator)" class="w-3.5 h-3.5 text-purple-600 rounded">
                                                                <span class="text-xs text-gray-500">AI</span>
                                                            </label>
                                                            <button @click="openTranslatorProfilesModal(translator)"
                                                                    class="w-8 h-8 rounded-lg bg-purple-100 hover:bg-purple-200 flex items-center justify-center"
                                                                    title="–ê–Ω–∫–µ—Ç—ã">
                                                                <i class="fas fa-folder text-purple-600 text-xs"></i>
                                                            </button>
                                                            <button @click="editTranslator(translator)"
                                                                    class="w-8 h-8 rounded-lg bg-blue-100 hover:bg-blue-200 flex items-center justify-center"
                                                                    title="–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å">
                                                                <i class="fas fa-edit text-blue-600 text-xs"></i>
                                                            </button>
                                                            <button @click="deleteTranslator(translator)"
                                                                    class="w-8 h-8 rounded-lg bg-red-100 hover:bg-red-200 flex items-center justify-center"
                                                                    title="–£–¥–∞–ª–∏—Ç—å">
                                                                <i class="fas fa-trash text-red-600 text-xs"></i>
                                                            </button>
                                                        </div>
                                                    </div>
                                                </template>
                                            </div>
                                        </div>
                                    </div>
                                </template>

                                <div x-show="admins.length === 0" class="text-center text-gray-500 py-8">
                                    <i class="fas fa-user-tie text-gray-300 text-4xl mb-3"></i>
                                    <div>–ù–µ—Ç –∞–¥–º–∏–Ω–æ–≤</div>
                                </div>
                            </div>
                        </div>

                        <!-- –°–µ–∫—Ü–∏—è –ú–æ–∏ –ø–µ—Ä–µ–≤–æ–¥—á–∏–∫–∏ (–Ω–∞–ø—Ä—è–º—É—é –ø–æ–¥ –¥–∏—Ä–µ–∫—Ç–æ—Ä–æ–º) -->
                        <div class="glass rounded-2xl p-5">
                            <div class="flex justify-between items-center mb-4">
                                <h3 class="text-lg font-bold">
                                    <i class="fas fa-language text-purple-500 mr-2"></i>–ú–æ–∏ –ø–µ—Ä–µ–≤–æ–¥—á–∏–∫–∏
                                </h3>
                                <button @click="openAddTranslatorModal()" class="px-4 py-2 rounded-xl text-sm font-medium bg-purple-500 hover:bg-purple-600 text-white transition-all">
                                    <i class="fas fa-plus mr-2"></i>–î–æ–±–∞–≤–∏—Ç—å –ø–µ—Ä–µ–≤–æ–¥—á–∏–∫–∞
                                </button>
                            </div>

                            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3">
                                <template x-for="translator in directTranslators" :key="translator.id">
                                    <div class="bg-gradient-to-r from-purple-50 to-pink-50 rounded-xl p-4 border border-purple-100">
                                        <div class="flex items-center justify-between">
                                            <div class="flex items-center">
                                                <div class="w-12 h-12 rounded-full bg-gradient-to-r from-purple-500 to-pink-500 flex items-center justify-center">
                                                    <span class="text-white font-bold" x-text="translator.name.charAt(0).toUpperCase()"></span>
                                                </div>
                                                <div class="ml-3">
                                                    <div class="font-semibold text-gray-800" x-text="translator.name"></div>
                                                    <div class="text-sm text-gray-500"><span x-text="translator.accountsCount || 0"></span> –∞–Ω–∫–µ—Ç</div>
                                                </div>
                                            </div>
                                            <div class="flex items-center gap-1">
                                                <!-- AI toggle -->
                                                <label class="flex items-center gap-1 px-2 py-1 rounded bg-white/50 cursor-pointer">
                                                    <input type="checkbox" :checked="translator.aiEnabled" @change="toggleAiEnabled(translator)" class="w-4 h-4 text-purple-600 rounded">
                                                    <span class="text-xs text-gray-600">AI</span>
                                                </label>
                                                <button @click="openTranslatorProfilesModal(translator)"
                                                        class="w-8 h-8 rounded-lg bg-purple-100 hover:bg-purple-200 flex items-center justify-center"
                                                        title="–ê–Ω–∫–µ—Ç—ã">
                                                    <i class="fas fa-folder text-purple-600 text-xs"></i>
                                                </button>
                                                <button @click="editTranslator(translator)"
                                                        class="w-8 h-8 rounded-lg bg-blue-100 hover:bg-blue-200 flex items-center justify-center"
                                                        title="–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å">
                                                    <i class="fas fa-edit text-blue-600 text-xs"></i>
                                                </button>
                                                <button @click="deleteTranslator(translator)"
                                                        class="w-8 h-8 rounded-lg bg-red-100 hover:bg-red-200 flex items-center justify-center"
                                                        title="–£–¥–∞–ª–∏—Ç—å">
                                                    <i class="fas fa-trash text-red-600 text-xs"></i>
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </template>
                            </div>

                            <div x-show="directTranslators.length === 0" class="text-center text-gray-500 py-8">
                                <i class="fas fa-language text-gray-300 text-4xl mb-3"></i>
                                <div>–ù–µ—Ç –ø–µ—Ä–µ–≤–æ–¥—á–∏–∫–æ–≤ –Ω–∞–ø—Ä—è–º—É—é –ø–æ–¥ –≤–∞–º–∏</div>
                            </div>
                        </div>
                    </div>
                </template>

                <!-- –î–ª—è –∞–¥–º–∏–Ω–∞ -->
                <template x-if="currentUser.role === 'admin'">
                    <div class="glass rounded-2xl p-5">
                        <div class="flex justify-between items-center mb-4">
                            <h3 class="text-lg font-bold">
                                <i class="fas fa-users text-indigo-500 mr-2"></i>–ú–æ–∏ –ø–µ—Ä–µ–≤–æ–¥—á–∏–∫–∏
                            </h3>
                            <button @click="openAddTranslatorModal()" class="px-4 py-2 rounded-xl text-sm font-medium bg-purple-500 hover:bg-purple-600 text-white transition-all">
                                <i class="fas fa-plus mr-2"></i>–î–æ–±–∞–≤–∏—Ç—å –ø–µ—Ä–µ–≤–æ–¥—á–∏–∫–∞
                            </button>
                        </div>

                        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3">
                            <template x-for="translator in myTranslators" :key="translator.id">
                                <div class="bg-gradient-to-r from-indigo-50 to-purple-50 rounded-xl p-4 border border-indigo-100">
                                    <div class="flex items-center justify-between">
                                        <div class="flex items-center">
                                            <div class="w-12 h-12 rounded-full bg-gradient-to-r from-indigo-500 to-purple-500 flex items-center justify-center">
                                                <span class="text-white font-bold" x-text="translator.name.charAt(0).toUpperCase()"></span>
                                            </div>
                                            <div class="ml-3">
                                                <div class="font-semibold text-gray-800" x-text="translator.name"></div>
                                                <div class="text-sm text-gray-500"><span x-text="translator.accountsCount || 0"></span> –∞–Ω–∫–µ—Ç</div>
                                            </div>
                                        </div>
                                        <div class="flex items-center gap-1">
                                            <!-- AI toggle (—Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ —É —Ç–µ–∫—É—â–µ–≥–æ –∞–¥–º–∏–Ω–∞ –≤–∫–ª—é—á–µ–Ω AI) -->
                                            <label x-show="currentUser.aiEnabled" class="flex items-center gap-1 px-2 py-1 rounded bg-white/50 cursor-pointer">
                                                <input type="checkbox" :checked="translator.aiEnabled" @change="toggleAiEnabled(translator)" class="w-4 h-4 text-purple-600 rounded">
                                                <span class="text-xs text-gray-600">AI</span>
                                            </label>
                                            <button @click="openTranslatorProfilesModal(translator)"
                                                    class="w-8 h-8 rounded-lg bg-indigo-100 hover:bg-indigo-200 flex items-center justify-center"
                                                    title="–ê–Ω–∫–µ—Ç—ã">
                                                <i class="fas fa-folder text-indigo-600 text-xs"></i>
                                            </button>
                                            <button @click="editTranslator(translator)"
                                                    class="w-8 h-8 rounded-lg bg-blue-100 hover:bg-blue-200 flex items-center justify-center"
                                                    title="–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å">
                                                <i class="fas fa-edit text-blue-600 text-xs"></i>
                                            </button>
                                            <button @click="deleteTranslator(translator)"
                                                    class="w-8 h-8 rounded-lg bg-red-100 hover:bg-red-200 flex items-center justify-center"
                                                    title="–£–¥–∞–ª–∏—Ç—å">
                                                <i class="fas fa-trash text-red-600 text-xs"></i>
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </template>
                        </div>

                        <div x-show="myTranslators.length === 0" class="text-center text-gray-500 py-8">
                            <i class="fas fa-users text-gray-300 text-4xl mb-3"></i>
                            <div>–£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç –ø–µ—Ä–µ–≤–æ–¥—á–∏–∫–æ–≤</div>
                        </div>
                    </div>
                </template>
            </div>

            <!-- –ê–Ω–∫–µ—Ç—ã -->
            <div x-show="activeMenu === 'accounts'" x-cloak class="fade-in">
                <!-- –°–ø–∏—Å–æ–∫ –∞–Ω–∫–µ—Ç -->
                <!-- –ü–∞–Ω–µ–ª—å —Ñ–∏–ª—å—Ç—Ä–æ–≤ –∏ –¥–µ–π—Å—Ç–≤–∏–π -->
                <div class="flex flex-wrap items-center justify-between gap-3 mb-4">
                    <div class="flex flex-wrap items-center gap-3">
                        <!-- –§–∏–ª—å—Ç—Ä –ø–æ –∞–¥–º–∏–Ω—É (—Ç–æ–ª—å–∫–æ –¥–ª—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∞) -->
                        <template x-if="currentUser.role === 'director'">
                            <select class="glass px-4 py-2.5 rounded-xl text-sm font-medium" x-model="adminFilter">
                                <option value="all">–í—Å–µ –∞–¥–º–∏–Ω—ã</option>
                                <option value="unassigned">–ë–µ–∑ –∞–¥–º–∏–Ω–∞</option>
                                <template x-for="admin in admins" :key="admin.id">
                                    <option :value="admin.id" x-text="admin.name"></option>
                                </template>
                            </select>
                        </template>

                        <!-- –§–∏–ª—å—Ç—Ä –ø–æ –ø–µ—Ä–µ–≤–æ–¥—á–∏–∫—É (–¥–ª—è –∞–¥–º–∏–Ω–∞) -->
                        <template x-if="currentUser.role === 'admin'">
                            <select class="glass px-4 py-2.5 rounded-xl text-sm font-medium" x-model="translatorFilter">
                                <option value="all">–í—Å–µ –ø–µ—Ä–µ–≤–æ–¥—á–∏–∫–∏</option>
                                <option value="unassigned">–ë–µ–∑ –ø–µ—Ä–µ–≤–æ–¥—á–∏–∫–∞</option>
                                <template x-for="translator in myTranslators" :key="translator.id">
                                    <option :value="translator.id" x-text="translator.name"></option>
                                </template>
                            </select>
                        </template>

                        <!-- –ü–æ–∏—Å–∫ -->
                        <div class="relative">
                            <input type="search" :placeholder="t('profiles.searchPlaceholder')"
                                   class="glass pl-10 pr-4 py-2.5 rounded-xl w-64"
                                   autocomplete="new-password"
                                   name="profile_search_field_unique"
                                   data-lpignore="true"
                                   data-form-type="other"
                                   x-model="searchQuery">
                            <i class="fas fa-search absolute left-3 top-3 text-gray-400"></i>
                        </div>
                    </div>

                    <!-- –ö–Ω–æ–ø–∫–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è -->
                    <button x-show="currentUser.role !== 'translator'" @click="showAddAccountModal = true" class="glow-button px-5 py-2.5 rounded-xl text-white font-medium">
                        <i class="fas fa-plus mr-2"></i><span x-text="t('common.add')"></span>
                    </button>
                </div>

                <!-- –ü–∞–Ω–µ–ª—å –º–∞—Å—Å–æ–≤—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π (–ø–æ—è–≤–ª—è–µ—Ç—Å—è –ø—Ä–∏ –≤—ã–±–æ—Ä–µ –∞–Ω–∫–µ—Ç) -->
                <div x-show="selectedProfileIds.length > 0"
                     x-transition:enter="transition ease-out duration-200"
                     x-transition:enter-start="opacity-0 transform -translate-y-2"
                     x-transition:enter-end="opacity-100 transform translate-y-0"
                     class="glass rounded-xl p-3 mb-4 flex items-center justify-between bg-gradient-to-r from-indigo-50 to-purple-50 border border-indigo-200 relative z-50">
                    <div class="flex items-center gap-2">
                        <span class="text-sm font-medium text-indigo-700">
                            <i class="fas fa-check-square mr-2"></i>
                            –í—ã–±—Ä–∞–Ω–æ: <span x-text="selectedProfileIds.length" class="font-bold"></span> –∞–Ω–∫–µ—Ç
                        </span>
                        <button @click="selectedProfileIds = []" class="text-gray-500 hover:text-gray-700 text-sm ml-2">
                            <i class="fas fa-times"></i> –°–±—Ä–æ—Å–∏—Ç—å
                        </button>
                    </div>
                    <div class="flex items-center gap-2">
                        <!-- –ù–∞–∑–Ω–∞—á–∏—Ç—å –∞–¥–º–∏–Ω—É (–¥–ª—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∞) -->
                        <template x-if="currentUser.role === 'director'">
                            <div class="relative" x-data="{ showDropdown: false }">
                                <button @click="showDropdown = !showDropdown"
                                        class="px-4 py-2 rounded-lg bg-indigo-500 hover:bg-indigo-600 text-white text-sm font-medium transition-colors">
                                    <i class="fas fa-user-tie mr-2"></i>–ù–∞–∑–Ω–∞—á–∏—Ç—å –∞–¥–º–∏–Ω—É
                                    <i class="fas fa-chevron-down ml-2 text-xs"></i>
                                </button>
                                <div x-show="showDropdown" @click.outside="showDropdown = false"
                                     class="absolute right-0 mt-2 w-48 bg-white rounded-xl shadow-xl border border-gray-100 py-2 z-[100] max-h-64 overflow-y-auto">
                                    <button @click="assignSelectedToAdmin(null); showDropdown = false"
                                            class="w-full px-4 py-2 text-left text-sm hover:bg-gray-50 text-gray-600">
                                        <i class="fas fa-ban mr-2"></i>–°–Ω—è—Ç—å –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ
                                    </button>
                                    <div class="border-t border-gray-100 my-1"></div>
                                    <template x-for="admin in admins" :key="admin.id">
                                        <button @click="assignSelectedToAdmin(admin.id); showDropdown = false"
                                                class="w-full px-4 py-2 text-left text-sm hover:bg-indigo-50 hover:text-indigo-700">
                                            <i class="fas fa-user mr-2"></i><span x-text="admin.name"></span>
                                        </button>
                                    </template>
                                </div>
                            </div>
                        </template>

                        <!-- –ù–∞–∑–Ω–∞—á–∏—Ç—å –ø–µ—Ä–µ–≤–æ–¥—á–∏–∫—É (–¥–ª—è –∞–¥–º–∏–Ω–∞) -->
                        <template x-if="currentUser.role === 'admin'">
                            <div class="relative" x-data="{ showDropdown: false }">
                                <button @click="showDropdown = !showDropdown"
                                        class="px-4 py-2 rounded-lg bg-purple-500 hover:bg-purple-600 text-white text-sm font-medium transition-colors">
                                    <i class="fas fa-language mr-2"></i>–ù–∞–∑–Ω–∞—á–∏—Ç—å –ø–µ—Ä–µ–≤–æ–¥—á–∏–∫—É
                                    <i class="fas fa-chevron-down ml-2 text-xs"></i>
                                </button>
                                <div x-show="showDropdown" @click.outside="showDropdown = false"
                                     class="absolute right-0 mt-2 w-48 bg-white rounded-xl shadow-xl border border-gray-100 py-2 z-[100] max-h-64 overflow-y-auto">
                                    <button @click="assignSelectedToTranslator(null); showDropdown = false"
                                            class="w-full px-4 py-2 text-left text-sm hover:bg-gray-50 text-gray-600">
                                        <i class="fas fa-ban mr-2"></i>–°–Ω—è—Ç—å –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ
                                    </button>
                                    <div class="border-t border-gray-100 my-1"></div>
                                    <template x-for="translator in myTranslators" :key="translator.id">
                                        <button @click="assignSelectedToTranslator(translator.id); showDropdown = false"
                                                class="w-full px-4 py-2 text-left text-sm hover:bg-purple-50 hover:text-purple-700">
                                            <i class="fas fa-user mr-2"></i><span x-text="translator.name"></span>
                                        </button>
                                    </template>
                                    <template x-if="myTranslators.length === 0">
                                        <div class="px-4 py-2 text-sm text-gray-400">–ù–µ—Ç –ø–µ—Ä–µ–≤–æ–¥—á–∏–∫–æ–≤</div>
                                    </template>
                                </div>
                            </div>
                        </template>

                        <!-- –û–ø–ª–∞—Ç–∏—Ç—å (–µ—Å–ª–∏ –Ω–µ –º–æ–π –∞–¥–º–∏–Ω) -->
                        <template x-if="!isRestricted">
                            <button @click="paySelectedProfiles()" class="px-4 py-2 rounded-lg bg-green-500 hover:bg-green-600 text-white text-sm font-medium transition-colors">
                                <i class="fas fa-credit-card mr-2"></i>–û–ø–ª–∞—Ç–∏—Ç—å
                            </button>
                        </template>

                        <!-- –£–¥–∞–ª–∏—Ç—å –≤—ã–±—Ä–∞–Ω–Ω—ã–µ -->
                        <button @click="deleteSelectedProfiles()" class="px-4 py-2 rounded-lg bg-red-500 hover:bg-red-600 text-white text-sm font-medium transition-colors">
                            <i class="fas fa-trash mr-2"></i>–£–¥–∞–ª–∏—Ç—å
                        </button>
                    </div>
                </div>
                
                <!-- –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ -->
                <div class="glass rounded-2xl overflow-hidden">
                    <div class="overflow-x-auto">
                        <table class="w-full resizable-table" id="profiles-table">
                            <thead>
                                <tr class="border-b border-gray-200 text-xs text-gray-600 uppercase tracking-wide">
                                    <!-- –ß–µ–∫–±–æ–∫—Å –¥–ª—è –≤—ã–±–æ—Ä–∞ –≤—Å–µ—Ö -->
                                    <th class="text-left py-1.5 px-2 w-10">
                                        <input type="checkbox"
                                               class="profile-checkbox"
                                               @change="toggleSelectAllProfiles($event.target.checked)"
                                               :checked="selectedProfileIds.length > 0 && selectedProfileIds.length === filteredAccounts.length"
                                               :indeterminate="selectedProfileIds.length > 0 && selectedProfileIds.length < filteredAccounts.length">
                                    </th>
                                    <th class="text-left py-1.5 px-2 cursor-pointer hover:bg-gray-50 font-medium" style="width: 100px;" @click="sortAccounts('id')">
                                        <div class="flex items-center gap-1 overflow-hidden">
                                            <span class="truncate" x-text="t('profiles.id')"></span>
                                            <i class="fas text-[10px] flex-shrink-0" :class="sortBy === 'id' ? (sortDirection === 'asc' ? 'fa-sort-up' : 'fa-sort-down') : 'fa-sort text-gray-300'"></i>
                                        </div>
                                        <div class="resize-handle" @mousedown.stop="initResize($event)"></div>
                                    </th>
                                    <th class="text-left py-1.5 px-2 cursor-pointer hover:bg-gray-50 font-medium" style="width: 100px;" @click="sortAccounts('status')">
                                        <div class="flex items-center gap-1 overflow-hidden">
                                            <span class="truncate" x-text="t('profiles.statusCol')"></span>
                                            <i class="fas text-[10px] flex-shrink-0" :class="sortBy === 'status' ? (sortDirection === 'asc' ? 'fa-sort-up' : 'fa-sort-down') : 'fa-sort text-gray-300'"></i>
                                        </div>
                                        <div class="resize-handle" @mousedown.stop="initResize($event)"></div>
                                    </th>
                                    <th class="text-left py-1.5 px-2 cursor-pointer hover:bg-gray-50 font-medium" style="width: 120px;" @click="sortAccounts('lastOnline')">
                                        <div class="flex items-center gap-1 overflow-hidden">
                                            <span class="truncate" x-text="t('profiles.lastOnline')"></span>
                                            <i class="fas text-[10px] flex-shrink-0" :class="sortBy === 'lastOnline' ? (sortDirection === 'asc' ? 'fa-sort-up' : 'fa-sort-down') : 'fa-sort text-gray-300'"></i>
                                        </div>
                                        <div class="resize-handle" @mousedown.stop="initResize($event)"></div>
                                    </th>
                                    <th class="text-left py-1.5 px-2 cursor-pointer hover:bg-gray-50 font-medium" style="width: 100px;" @click="sortAccounts('incoming')">
                                        <div class="flex items-center gap-1 overflow-hidden">
                                            <span class="truncate" x-text="t('profiles.incoming')"></span>
                                            <i class="fas text-[10px] flex-shrink-0" :class="sortBy === 'incoming' ? (sortDirection === 'asc' ? 'fa-sort-up' : 'fa-sort-down') : 'fa-sort text-gray-300'"></i>
                                        </div>
                                        <div class="resize-handle" @mousedown.stop="initResize($event)"></div>
                                    </th>
                                    <th x-show="currentUser.role === 'director'" class="text-left py-1.5 px-2 cursor-pointer hover:bg-gray-50 font-medium" style="width: 120px;" @click="sortAccounts('admin')">
                                        <div class="flex items-center gap-1 overflow-hidden">
                                            <span class="truncate" x-text="t('profiles.admin')"></span>
                                            <i class="fas text-[10px] flex-shrink-0" :class="sortBy === 'admin' ? (sortDirection === 'asc' ? 'fa-sort-up' : 'fa-sort-down') : 'fa-sort text-gray-300'"></i>
                                        </div>
                                        <div class="resize-handle" @mousedown.stop="initResize($event)"></div>
                                    </th>
                                    <!-- –ö–æ–ª–æ–Ω–∫–∞ –ü–µ—Ä–µ–≤–æ–¥—á–∏–∫ –¥–ª—è –∞–¥–º–∏–Ω–∞ -->
                                    <th x-show="currentUser.role === 'admin'" class="text-left py-1.5 px-2 cursor-pointer hover:bg-gray-50 font-medium" style="width: 120px;" @click="sortAccounts('translator')">
                                        <div class="flex items-center gap-1 overflow-hidden">
                                            <span class="truncate">–ü–µ—Ä–µ–≤–æ–¥—á–∏–∫</span>
                                            <i class="fas text-[10px] flex-shrink-0" :class="sortBy === 'translator' ? (sortDirection === 'asc' ? 'fa-sort-up' : 'fa-sort-down') : 'fa-sort text-gray-300'"></i>
                                        </div>
                                        <div class="resize-handle" @mousedown.stop="initResize($event)"></div>
                                    </th>
                                    <th class="text-left py-1.5 px-2 cursor-pointer hover:bg-gray-50 font-medium" style="width: 120px;" @click="sortAccounts('date')">
                                        <div class="flex items-center gap-1 overflow-hidden">
                                            <span class="truncate" x-text="t('profiles.addedDate')"></span>
                                            <i class="fas text-[10px] flex-shrink-0" :class="sortBy === 'date' ? (sortDirection === 'asc' ? 'fa-sort-up' : 'fa-sort-down') : 'fa-sort text-gray-300'"></i>
                                        </div>
                                        <div class="resize-handle" @mousedown.stop="initResize($event)"></div>
                                    </th>
                                    <th class="text-left py-1.5 px-2 font-medium" style="width: 150px;">
                                        <div class="flex items-center overflow-hidden">
                                            <span class="truncate" x-text="t('profiles.commentCol')"></span>
                                        </div>
                                        <div class="resize-handle" @mousedown.stop="initResize($event)"></div>
                                    </th>
                                    <th class="text-left py-1.5 px-2 font-medium" style="width: 100px;">
                                        <div class="flex items-center overflow-hidden">
                                            <span class="truncate">–û–ø–ª–∞—Ç–∞</span>
                                        </div>
                                        <div class="resize-handle" @mousedown.stop="initResize($event)"></div>
                                    </th>
                                    <th class="text-left py-1.5 px-2 font-medium">
                                        <div class="flex items-center overflow-hidden">
                                            <span class="truncate" x-text="t('common.actions')"></span>
                                        </div>
                                    </th>
                                </tr>
                            </thead>
                            <tbody>
                                <template x-for="account in filteredAccounts" :key="account.id">
                                    <tr class="border-b border-gray-100 hover:bg-gray-50 transition-colors text-sm"
                                        :class="{'bg-red-50': account.paused,
                                                'account-online': account.status === 'online' && !account.paused,
                                                'account-offline': account.status === 'offline' && !account.paused}">
                                        <!-- –ß–µ–∫–±–æ–∫—Å –¥–ª—è –≤—ã–±–æ—Ä–∞ -->
                                        <td class="py-1.5 px-2">
                                            <input type="checkbox"
                                                   class="profile-checkbox"
                                                   :value="account.id"
                                                   :checked="selectedProfileIds.includes(String(account.id))"
                                                   @change="toggleProfileSelection(account.id, $event.target.checked)">
                                        </td>
                                        <td class="py-1.5 px-2 font-mono" x-text="account.id"></td>
                                        <td class="py-1.5 px-2">
                                            <span class="px-2 py-0.5 rounded-full text-xs"
                                                  :class="getStatusClass(account.status)"
                                                  x-text="getStatusText(account.status)">
                                            </span>
                                        </td>
                                        <td class="py-1.5 px-2 text-gray-500">
                                            <span x-show="account.status === 'online' || account.status === 'working'">-</span>
                                            <span x-show="!(account.status === 'online' || account.status === 'working')" x-text="account.lastOnline || '-'"></span>
                                        </td>
                                        <td class="py-1.5 px-2">
                                            <span class="px-2 py-0.5 rounded text-xs"
                                                  :class="account.incoming > 0 ? 'bg-white text-green-600 font-medium shadow-sm' : 'bg-gray-100 text-gray-400'"
                                                  x-text="account.incoming || 0"></span>
                                        </td>
                                        <td x-show="currentUser.role === 'director'" class="py-1.5 px-2">
                                            <span class="text-xs font-medium"
                                                  :class="account.admin ? getAdminColor(account.adminId, account.admin) : 'text-gray-400'"
                                                  x-text="account.admin || '–ù–µ—Ç –∞–¥–º–∏–Ω–∞'"></span>
                                        </td>
                                        <!-- –ö–æ–ª–æ–Ω–∫–∞ –ü–µ—Ä–µ–≤–æ–¥—á–∏–∫ –¥–ª—è –∞–¥–º–∏–Ω–∞ -->
                                        <td x-show="currentUser.role === 'admin'" class="py-1.5 px-2">
                                            <span class="px-2 py-0.5 rounded text-xs"
                                                  :class="account.translatorName ? 'bg-purple-100 text-purple-700' : 'bg-gray-100 text-gray-400'"
                                                  x-text="account.translatorName || '–ù–µ –Ω–∞–∑–Ω–∞—á–µ–Ω'"></span>
                                        </td>
                                        <td class="py-1.5 px-2 text-gray-500" x-text="account.addedDate"></td>
                                        <td class="py-1.5 px-2 max-w-xs">
                                            <div class="truncate text-gray-600" :title="account.comment" x-text="account.comment"></div>
                                        </td>
                                        <!-- –û–ø–ª–∞—Ç–∞ -->
                                        <td class="py-1.5 px-2">
                                            <div class="flex items-center space-x-2">
                                                <span class="text-xs font-medium" :class="getPaymentStatusClass(account)" x-text="getPaymentStatusText(account)"></span>
                                                <!-- –ö–Ω–æ–ø–∫–∏ –æ–ø–ª–∞—Ç—ã (—Ç–æ–ª—å–∫–æ –¥–ª—è admin –Ω–µ "–º–æ–π –∞–¥–º–∏–Ω") -->
                                                <template x-if="currentUser.role === 'admin' && !isRestricted && !account.isFree">
                                                    <div class="flex items-center space-x-1">
                                                        <!-- –ö–Ω–æ–ø–∫–∞ trial –µ—Å–ª–∏ –Ω–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω -->
                                                        <button x-show="!account.trialUsed && !account.isPaid"
                                                                @click="startTrial(account)"
                                                                class="px-2 py-0.5 text-xs bg-blue-100 text-blue-600 rounded hover:bg-blue-200"
                                                                title="–ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–π –ø–µ—Ä–∏–æ–¥ (2 –¥–Ω—è)">
                                                            Trial
                                                        </button>
                                                        <!-- –ö–Ω–æ–ø–∫–∞ –ø—Ä–æ–¥–ª–∏—Ç—å -->
                                                        <button @click="openExtendModal(account)"
                                                                class="px-2 py-0.5 text-xs bg-green-100 text-green-600 rounded hover:bg-green-200"
                                                                title="–ü—Ä–æ–¥–ª–∏—Ç—å –∞–Ω–∫–µ—Ç—É">
                                                            <i class="fas fa-plus"></i>
                                                        </button>
                                                    </div>
                                                </template>
                                            </div>
                                        </td>
                                        <td class="py-1.5 px-2">
                                            <div class="flex items-center space-x-2">
                                                <button @click="deleteAccount(account)"
                                                        class="p-1 rounded text-red-500 hover:text-red-700 hover:bg-red-50"
                                                        title="–£–¥–∞–ª–∏—Ç—å">
                                                    <i class="fas fa-trash"></i>
                                                </button>
                                            </div>
                                        </td>
                                    </tr>
                                </template>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            
            <!-- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ -->
            <div x-show="activeMenu === 'control' && currentUser.role === 'director'" x-cloak class="fade-in">
                <div class="grid grid-cols-2 gap-6">
                    <!-- –°–µ—Å—Å–∏–∏ -->
                    <div class="glass rounded-2xl p-6">
                        <h3 class="text-lg font-bold mb-6" x-text="t('control.activeSessions')"></h3>
                        <div class="space-y-4">
                            <!-- –°–æ–æ–±—â–µ–Ω–∏–µ –µ—Å–ª–∏ –±–æ—Ç–æ–≤ –Ω–µ—Ç -->
                            <div x-show="bots.length === 0" class="text-center py-8 text-gray-500">
                                <i class="fas fa-robot text-4xl mb-3 opacity-30"></i>
                                <p>–ù–µ—Ç –∞–∫—Ç–∏–≤–Ω—ã—Ö –±–æ—Ç–æ–≤</p>
                                <p class="text-sm">–ë–æ—Ç—ã –ø–æ—è–≤—è—Ç—Å—è –∑–¥–µ—Å—å –ø–æ—Å–ª–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è</p>
                            </div>
                            <template x-for="bot in bots" :key="bot.id">
                                <div class="p-4 rounded-xl border border-gray-100">
                                    <div class="flex items-center justify-between mb-3">
                                        <div class="flex items-center">
                                            <i :class="bot.icon + ' mr-3'" :class="bot.status === 'active' ? 'text-green-500' : 'text-red-500'"></i>
                                            <div>
                                                <div class="font-medium flex items-center">
                                                    <span x-text="bot.name"></span>
                                                    <span class="ml-2 text-xs px-2 py-0.5 rounded-full" 
                                                          :class="bot.status === 'active' ? 'bg-green-100 text-green-800' : 'bg-red-100 text-red-800'"
                                                          x-text="bot.status === 'active' ? '–ê–∫—Ç–∏–≤–µ–Ω' : '–ù–µ–∞–∫—Ç–∏–≤–µ–Ω'">
                                                    </span>
                                                </div>
                                                <div class="text-sm text-gray-500" x-text="bot.os"></div>
                                            </div>
                                        </div>
                                        <div>
                                            <button @click="toggleBotStatus(bot)" 
                                                    class="px-3 py-1 rounded-lg text-sm"
                                                    :class="bot.status === 'active' ? 'bg-red-100 text-red-600 hover:bg-red-200' : 'bg-green-100 text-green-600 hover:bg-green-200'">
                                                <span x-text="bot.status === 'active' ? '–í—ã–∫–ª—é—á–∏—Ç—å' : '–ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å'"></span>
                                            </button>
                                        </div>
                                    </div>
                                    
                                    <!-- –î–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è -->
                                    <div class="grid grid-cols-2 gap-2 text-sm text-gray-600">
                                        <div>
                                            <span class="font-medium">IP:</span>
                                            <span x-text="bot.ip"></span>
                                        </div>
                                        <div>
                                            <span class="font-medium">–í–µ—Ä—Å–∏—è:</span>
                                            <span x-text="bot.version"></span>
                                        </div>
                                        <div>
                                            <span class="font-medium">–ê–Ω–∫–µ—Ç:</span>
                                            <span x-text="bot.profilesCount"></span>
                                        </div>
                                        <div>
                                            <span class="font-medium">–ü–æ—Å–ª–µ–¥–Ω–∏–π –æ—Ç–∫–ª–∏–∫:</span>
                                            <span x-text="bot.lastHeartbeat ? new Date(bot.lastHeartbeat).toLocaleString('ru-RU') : '-'"></span>
                                        </div>
                                    </div>

                                    <!-- –ï—Å–ª–∏ –±–æ—Ç –Ω–µ–∞–∫—Ç–∏–≤–µ–Ω - –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –∏–∑–º–µ–Ω–∏—Ç—å –Ω–∞–∑–≤–∞–Ω–∏–µ -->
                                    <div x-show="bot.status === 'inactive'" class="mt-3 pt-3 border-t border-gray-100">
                                        <!-- –ò–∑–º–µ–Ω–µ–Ω–∏–µ –Ω–∞–∑–≤–∞–Ω–∏—è -->
                                        <div class="flex items-center space-x-2">
                                            <input type="text"
                                                   x-model="bot.name"
                                                   class="flex-1 glass px-3 py-1 rounded-lg text-sm"
                                                   :placeholder="t('control.botName')">
                                            <button @click="saveBotName(bot)"
                                                    class="px-2 py-1 bg-blue-100 text-blue-600 rounded-lg text-sm hover:bg-blue-200">
                                                –°–æ—Ö—Ä–∞–Ω–∏—Ç—å
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </template>
                        </div>
                    </div>
                    
                    <!-- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ -->
                    <div class="glass rounded-2xl p-6">
                        <h3 class="text-lg font-bold mb-6" x-text="t('control.mailingSettings')"></h3>
                        <div class="space-y-4">
                            <div class="flex items-center justify-between">
                                <div>
                                    <div class="font-medium" x-text="t('control.enableMailing')"></div>
                                    <div class="text-sm text-gray-500" x-text="t('control.autoMessages')"></div>
                                </div>
                                <div class="ios-toggle"
                                     :class="{ 'active': controlSettings.mailingEnabled }"
                                     @click="toggleMailingEnabled()"></div>
                            </div>
                            <div class="flex items-center justify-between">
                                <div>
                                    <div class="font-medium" x-text="t('control.stopSpam')"></div>
                                    <div class="text-sm text-gray-500" x-text="t('control.onComplaints')"></div>
                                </div>
                                <div class="ios-toggle"
                                     :class="{ 'active': controlSettings.stopSpam }"
                                     @click="toggleStopSpam()"></div>
                            </div>
                        </div>

                        <div class="mt-8">
                            <button @click="activatePanicMode()"
                                    class="w-full py-3 rounded-xl text-white font-medium transition-all"
                                    :class="controlSettings.panicMode ? 'bg-green-500 hover:bg-green-600' : 'bg-gradient-to-r from-red-500 to-pink-500 hover:from-red-600 hover:to-pink-600'">
                                <span x-text="controlSettings.panicMode ? 'üü¢ –û—Ç–∫–ª—é—á–∏—Ç—å Panic Mode' : 'üö® Panic Mode'"></span>
                            </button>
                        </div>
                    </div>
                </div>
                
                <!-- –ö–Ω–æ–ø–∫–∞ "–û–±–Ω–æ–≤–∏—Ç—å –≤—Å–µ –±–æ—Ç—ã" -->
                <div class="mt-6">
                    <button @click="updateAllBots" class="glow-button px-5 py-2.5 rounded-xl text-white font-medium">
                        <i class="fas fa-sync mr-2"></i>–û–±–Ω–æ–≤–∏—Ç—å –≤—Å–µ –±–æ—Ç—ã
                    </button>
                </div>

                <!-- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∞–Ω–∫–µ—Ç–∞–º–∏ -->
                <div class="glass rounded-2xl p-6 mt-6">
                    <div class="flex items-center justify-between mb-4">
                        <h3 class="text-lg font-bold">
                            <i class="fas fa-user-cog text-blue-500 mr-2"></i>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∞–Ω–∫–µ—Ç–∞–º–∏
                        </h3>
                        <div class="flex items-center space-x-2">
                            <button @click="toggleAllProfilesMailing(true)"
                                    class="px-3 py-1 text-sm bg-green-100 text-green-700 rounded-lg hover:bg-green-200">
                                <i class="fas fa-play mr-1"></i>–ó–∞–ø—É—Å—Ç–∏—Ç—å –≤—Å–µ
                            </button>
                            <button @click="toggleAllProfilesMailing(false)"
                                    class="px-3 py-1 text-sm bg-red-100 text-red-700 rounded-lg hover:bg-red-200">
                                <i class="fas fa-stop mr-1"></i>–û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≤—Å–µ
                            </button>
                        </div>
                    </div>

                    <!-- –§–∏–ª—å—Ç—Ä—ã –ø–æ –∞–¥–º–∏–Ω—É –∏ –ø–µ—Ä–µ–≤–æ–¥—á–∏–∫—É -->
                    <div class="flex items-center space-x-4 mb-4 p-3 bg-gray-50 rounded-xl">
                        <div class="flex items-center space-x-2">
                            <label class="text-sm text-gray-600"><i class="fas fa-user-shield mr-1"></i>–ê–¥–º–∏–Ω:</label>
                            <select x-model="controlFilter.adminId" @change="onAdminFilterChange()"
                                    class="text-sm px-3 py-1.5 border rounded-lg bg-white">
                                <option value="">–í—Å–µ –∞–¥–º–∏–Ω—ã</option>
                                <template x-for="admin in team.filter(t => t.role === 'admin')" :key="admin.id">
                                    <option :value="admin.id" x-text="admin.name || admin.username"></option>
                                </template>
                            </select>
                        </div>
                        <div class="flex items-center space-x-2" x-show="controlFilter.adminId">
                            <label class="text-sm text-gray-600"><i class="fas fa-user mr-1"></i>–ü–µ—Ä–µ–≤–æ–¥—á–∏–∫:</label>
                            <select x-model="controlFilter.translatorId"
                                    class="text-sm px-3 py-1.5 border rounded-lg bg-white">
                                <option value="">–í—Å–µ –ø–µ—Ä–µ–≤–æ–¥—á–∏–∫–∏</option>
                                <template x-for="translator in getTranslatorsForAdmin()" :key="translator.id">
                                    <option :value="translator.id" x-text="translator.name || translator.username"></option>
                                </template>
                            </select>
                        </div>
                        <div class="text-sm text-gray-500">
                            <span x-text="getFilteredProfiles().length"></span> –∏–∑ <span x-text="profilesWithMailing.length"></span> –∞–Ω–∫–µ—Ç
                        </div>
                    </div>

                    <!-- –û–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏ –∞–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ -->
                    <div class="bg-gradient-to-r from-blue-50 to-green-50 rounded-xl p-4 mb-4">
                        <div class="flex items-center justify-between">
                            <div class="flex items-center space-x-4">
                                <!-- –ü–∏—Å—å–º–∞ -->
                                <div class="flex items-center space-x-2 bg-white/50 rounded-lg px-3 py-2">
                                    <i class="fas fa-envelope text-blue-500"></i>
                                    <div class="text-center">
                                        <div class="text-xl font-bold text-blue-600" x-text="getTotalMailToday()"></div>
                                        <div class="text-xs text-gray-500">–ü–∏—Å–µ–º —Å–µ–≥–æ–¥–Ω—è</div>
                                    </div>
                                    <div class="text-center border-l pl-2">
                                        <div class="text-lg font-bold text-blue-500" x-text="getTotalMailHour()"></div>
                                        <div class="text-xs text-gray-400">–∑–∞ —á–∞—Å</div>
                                    </div>
                                </div>
                                <!-- –ß–∞—Ç—ã -->
                                <div class="flex items-center space-x-2 bg-white/50 rounded-lg px-3 py-2">
                                    <i class="fas fa-comments text-green-500"></i>
                                    <div class="text-center">
                                        <div class="text-xl font-bold text-green-600" x-text="getTotalChatToday()"></div>
                                        <div class="text-xs text-gray-500">–ß–∞—Ç–æ–≤ —Å–µ–≥–æ–¥–Ω—è</div>
                                    </div>
                                    <div class="text-center border-l pl-2">
                                        <div class="text-lg font-bold text-green-500" x-text="getTotalChatHour()"></div>
                                        <div class="text-xs text-gray-400">–∑–∞ —á–∞—Å</div>
                                    </div>
                                </div>
                                <!-- –û—à–∏–±–∫–∏ -->
                                <div class="text-center" x-show="getTotalErrorsToday() > 0">
                                    <div class="text-xl font-bold text-red-600" x-text="getTotalErrorsToday()"></div>
                                    <div class="text-xs text-gray-500">–û—à–∏–±–æ–∫</div>
                                </div>
                                <!-- –û–Ω–ª–∞–π–Ω -->
                                <div class="text-center">
                                    <div class="text-xl font-bold text-purple-600" x-text="getOnlineProfiles()"></div>
                                    <div class="text-xs text-gray-500">–û–Ω–ª–∞–π–Ω</div>
                                </div>
                            </div>
                            <div class="flex items-center space-x-2">
                                <label class="flex items-center space-x-2 text-sm text-gray-600">
                                    <input type="checkbox" x-model="autoRefreshStats" @change="toggleAutoRefresh()" class="rounded">
                                    <span>–ê–≤—Ç–æ (30 —Å–µ–∫)</span>
                                </label>
                                <button @click="refreshProfileStats()"
                                        class="p-2 bg-white rounded-lg shadow hover:shadow-md transition-shadow"
                                        :class="{'animate-spin': refreshingStats}">
                                    <i class="fas fa-sync-alt text-blue-500"></i>
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- –°–ø–∏—Å–æ–∫ –∞–Ω–∫–µ—Ç —Å —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ–º -->
                    <div class="space-y-2 max-h-96 overflow-y-auto" id="profiles-list">
                        <template x-for="profile in getFilteredProfiles()" :key="profile.profileId">
                            <div class="p-3 bg-gray-50 rounded-lg">
                                <div class="flex items-center justify-between">
                                    <div class="flex items-center space-x-3">
                                        <div class="w-2 h-2 rounded-full animate-pulse"
                                             :class="profile.status === 'online' ? 'bg-green-500' : 'bg-gray-300'"></div>
                                        <div>
                                            <span class="font-medium" x-text="profile.profileId"></span>
                                            <span class="text-xs text-gray-400 ml-2" x-text="profile.note || ''"></span>
                                        </div>
                                    </div>
                                    <div class="flex items-center space-x-2">
                                        <span class="text-xs px-2 py-0.5 rounded-full"
                                              :class="profile.mailingEnabled ? 'bg-green-100 text-green-700' : 'bg-gray-100 text-gray-500'"
                                              x-text="profile.mailingEnabled ? '–†–∞—Å—Å—ã–ª–∫–∞ ON' : '–†–∞—Å—Å—ã–ª–∫–∞ OFF'"></span>
                                        <button @click="toggleProfileMailing(profile)"
                                                class="p-1.5 rounded-lg transition-colors"
                                                :class="profile.mailingEnabled ? 'bg-red-100 text-red-600 hover:bg-red-200' : 'bg-green-100 text-green-600 hover:bg-green-200'">
                                            <i :class="profile.mailingEnabled ? 'fas fa-pause' : 'fas fa-play'"></i>
                                        </button>
                                    </div>
                                </div>
                                <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –æ—Ç–ø—Ä–∞–≤–æ–∫: –ø–∏—Å—å–º–∞ –∏ —á–∞—Ç—ã -->
                                <div class="mt-2 flex items-center space-x-4 text-xs">
                                    <div class="flex items-center space-x-1" title="–ü–∏—Å—å–º–∞">
                                        <i class="fas fa-envelope text-blue-500"></i>
                                        <span class="font-bold text-blue-600" x-text="profile.mailToday || 0"></span>
                                        <span class="text-gray-400">/</span>
                                        <span class="text-blue-400" x-text="profile.mailHour || 0"></span>
                                    </div>
                                    <div class="flex items-center space-x-1" title="–ß–∞—Ç—ã">
                                        <i class="fas fa-comments text-green-500"></i>
                                        <span class="font-bold text-green-600" x-text="profile.chatToday || 0"></span>
                                        <span class="text-gray-400">/</span>
                                        <span class="text-green-400" x-text="profile.chatHour || 0"></span>
                                    </div>
                                    <div class="flex items-center space-x-1" x-show="profile.errorsToday > 0">
                                        <i class="fas fa-exclamation-triangle text-red-500"></i>
                                        <span class="font-bold text-red-600" x-text="profile.errorsToday"></span>
                                    </div>
                                </div>
                                <!-- –ü—Ä–æ–∫—Å–∏ -->
                                <div class="mt-2 flex items-center space-x-2">
                                    <span class="text-xs text-gray-500 w-12"><i class="fas fa-globe mr-1"></i>–ü—Ä–æ–∫—Å–∏:</span>
                                    <input type="text"
                                           class="flex-1 text-xs px-2 py-1 border rounded-lg bg-white"
                                           placeholder="ip:port:user:pass –∏–ª–∏ ip:port"
                                           :value="profile.proxy || ''"
                                           @change="updateProfileProxy(profile, $event.target.value)">
                                    <button @click="updateProfileProxy(profile, '')"
                                            x-show="profile.proxy"
                                            class="text-xs text-red-500 hover:text-red-700">
                                        <i class="fas fa-times"></i>
                                    </button>
                                </div>
                            </div>
                        </template>
                        <div x-show="getFilteredProfiles().length === 0" class="text-center py-4 text-gray-400">
                            <i class="fas fa-users text-2xl mb-2"></i>
                            <p class="text-sm">–ù–µ—Ç –∞–Ω–∫–µ—Ç –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è</p>
                        </div>
                    </div>
                </div>

                <!-- –ü—Ä–æ–º—Ç –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ -->
                <div class="glass rounded-2xl p-6 mt-6">
                    <h3 class="text-lg font-bold mb-4" x-text="t('control.generationPrompt')"></h3>
                    <textarea
                        class="glass w-full px-4 py-3 rounded-xl"
                        rows="4"
                        :placeholder="t('control.promptPlaceholder')"
                        x-model="generationPrompt"></textarea>
                    <p class="text-sm text-gray-500 mt-2" x-text="t('control.promptSync')"></p>
                    <button @click="syncPromptWithBots" class="mt-3 glow-button px-5 py-2.5 rounded-xl text-white text-sm font-medium" x-text="t('control.syncWithBots')">
                    </button>
                </div>

                <!-- –ò—Å—Ç–æ—Ä–∏—è –æ—à–∏–±–æ–∫ -->
                <div class="glass rounded-2xl p-6 mt-6">
                    <div class="flex items-center justify-between mb-4">
                        <h3 class="text-lg font-bold">
                            <i class="fas fa-exclamation-triangle text-red-500 mr-2"></i>–ò—Å—Ç–æ—Ä–∏—è –æ—à–∏–±–æ–∫
                        </h3>
                        <button @click="loadErrorLogs()" class="text-sm text-blue-600 hover:text-blue-800">
                            <i class="fas fa-sync-alt mr-1"></i>–û–±–Ω–æ–≤–∏—Ç—å
                        </button>
                    </div>

                    <!-- –õ–æ–≥ –æ—à–∏–±–æ–∫ –≤ —Å—Ç–∏–ª–µ —á–∞—Ç–∞ -->
                    <div class="bg-gray-50 rounded-xl p-4 max-h-80 overflow-y-auto" id="error-logs-container">
                        <div x-show="errorLogs.length === 0" class="text-center py-8 text-gray-400">
                            <i class="fas fa-check-circle text-4xl mb-3 text-green-300"></i>
                            <p>–û—à–∏–±–æ–∫ –Ω–µ—Ç</p>
                        </div>
                        <div class="space-y-3">
                            <template x-for="error in errorLogs" :key="error.id">
                                <div class="flex items-start space-x-3 p-3 bg-white rounded-lg border-l-4"
                                     :class="error.error_type === 'critical' ? 'border-red-500' : 'border-yellow-500'">
                                    <div class="flex-shrink-0">
                                        <i class="fas fa-exclamation-circle text-lg"
                                           :class="error.error_type === 'critical' ? 'text-red-500' : 'text-yellow-500'"></i>
                                    </div>
                                    <div class="flex-1 min-w-0">
                                        <div class="flex items-center justify-between">
                                            <span class="text-sm font-medium text-gray-900" x-text="error.endpoint || '–°–∏—Å—Ç–µ–º–∞'"></span>
                                            <span class="text-xs text-gray-400" x-text="formatErrorTime(error.timestamp)"></span>
                                        </div>
                                        <p class="text-sm text-gray-600 mt-1" x-text="error.error_message || error.message || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞'"></p>
                                        <div x-show="error.user_id" class="text-xs text-gray-400 mt-1">
                                            <span>–ü—Ä–æ—Ñ–∏–ª—å: </span>
                                            <span x-text="error.user_id"></span>
                                        </div>
                                    </div>
                                </div>
                            </template>
                        </div>
                    </div>

                    <!-- –ö–Ω–æ–ø–∫–∞ –∑–∞–≥—Ä—É–∑–∏—Ç—å –±–æ–ª—å—à–µ -->
                    <div x-show="errorLogs.length >= 20" class="mt-3 text-center">
                        <button @click="loadMoreErrors()" class="text-sm text-gray-500 hover:text-gray-700">
                            –ó–∞–≥—Ä—É–∑–∏—Ç—å –µ—â—ë...
                        </button>
                    </div>
                </div>

                <!-- –õ–æ–≥–∏ –±–æ—Ç–æ–≤ -->
                <div class="glass rounded-2xl p-6 mt-6">
                    <div class="flex items-center justify-between mb-4">
                        <h3 class="text-lg font-bold">
                            <i class="fas fa-terminal text-blue-500 mr-2"></i>–õ–æ–≥–∏ –±–æ—Ç–æ–≤
                        </h3>
                        <div class="flex items-center space-x-3">
                            <select x-model="botLogsFilter" @change="loadBotLogs()" class="text-sm glass px-3 py-1.5 rounded-lg">
                                <option value="">–í—Å–µ —Ç–∏–ø—ã</option>
                                <option value="mail_start">–°—Ç–∞—Ä—Ç —Ä–∞—Å—Å—ã–ª–∫–∏</option>
                                <option value="mail_stop">–°—Ç–æ–ø —Ä–∞—Å—Å—ã–ª–∫–∏</option>
                                <option value="chat_start">–°—Ç–∞—Ä—Ç —á–∞—Ç–∞</option>
                                <option value="chat_stop">–°—Ç–æ–ø —á–∞—Ç–∞</option>
                                <option value="chat">–°–æ–æ–±—â–µ–Ω–∏—è —á–∞—Ç–∞</option>
                                <option value="mail">–ü–∏—Å—å–º–∞</option>
                                <option value="vip-online">VIP –æ–Ω–ª–∞–π–Ω</option>
                                <option value="error">–û—à–∏–±–∫–∏</option>
                            </select>
                            <button @click="loadBotLogs()" class="text-sm text-blue-600 hover:text-blue-800">
                                <i class="fas fa-sync-alt mr-1"></i>–û–±–Ω–æ–≤–∏—Ç—å
                            </button>
                        </div>
                    </div>

                    <!-- –õ–æ–≥ –±–æ—Ç–æ–≤ -->
                    <div class="bg-gray-50 rounded-xl p-4 max-h-96 overflow-y-auto" id="bot-logs-container">
                        <div x-show="botLogs.length === 0" class="text-center py-8 text-gray-400">
                            <i class="fas fa-list-alt text-4xl mb-3 text-gray-300"></i>
                            <p>–õ–æ–≥–æ–≤ –ø–æ–∫–∞ –Ω–µ—Ç</p>
                        </div>
                        <div class="space-y-2">
                            <template x-for="log in botLogs" :key="log.id">
                                <div class="flex items-start space-x-3 p-2 bg-white rounded-lg border-l-4"
                                     :class="{
                                         'border-green-500': log.log_type.includes('start'),
                                         'border-red-500': log.log_type.includes('stop') || log.log_type === 'error',
                                         'border-blue-500': log.log_type === 'chat',
                                         'border-purple-500': log.log_type === 'mail',
                                         'border-yellow-500': log.log_type === 'vip-online',
                                         'border-gray-300': !['start', 'stop', 'chat', 'mail', 'vip-online', 'error'].some(t => log.log_type.includes(t))
                                     }">
                                    <div class="flex-shrink-0">
                                        <i class="fas text-sm"
                                           :class="{
                                               'fa-play text-green-500': log.log_type.includes('start'),
                                               'fa-stop text-red-500': log.log_type.includes('stop'),
                                               'fa-comment text-blue-500': log.log_type === 'chat',
                                               'fa-envelope text-purple-500': log.log_type === 'mail',
                                               'fa-crown text-yellow-500': log.log_type === 'vip-online',
                                               'fa-exclamation text-red-500': log.log_type === 'error',
                                               'fa-info-circle text-gray-400': !['start', 'stop', 'chat', 'mail', 'vip-online', 'error'].some(t => log.log_type.includes(t))
                                           }"></i>
                                    </div>
                                    <div class="flex-1 min-w-0">
                                        <div class="flex items-center justify-between">
                                            <span class="text-xs font-medium text-gray-500" x-text="log.profile_id || '–°–∏—Å—Ç–µ–º–∞'"></span>
                                            <span class="text-xs text-gray-400" x-text="formatBotLogTime(log.created_at)"></span>
                                        </div>
                                        <p class="text-sm text-gray-700" x-text="log.message"></p>
                                    </div>
                                </div>
                            </template>
                        </div>
                    </div>

                    <!-- –ü–∞–≥–∏–Ω–∞—Ü–∏—è -->
                    <div x-show="botLogsHasMore" class="mt-3 text-center">
                        <button @click="loadMoreBotLogs()" class="text-sm text-gray-500 hover:text-gray-700">
                            –ó–∞–≥—Ä—É–∑–∏—Ç—å –µ—â—ë...
                        </button>
                    </div>
                </div>
            </div>

            <!-- –û–±—É—á–µ–Ω–∏–µ -->
            <div x-show="activeMenu === 'training'" x-cloak class="fade-in">
                <div class="glass rounded-2xl p-6">
                    <h3 class="text-xl font-bold mb-6" x-text="t('training.title')"></h3>
                    <div class="grid grid-cols-2 gap-6">
                        <div class="p-4 rounded-xl bg-gradient-to-r from-blue-50 to-indigo-50">
                            <i class="fas fa-book text-blue-500 text-2xl mb-3"></i>
                            <h4 class="font-bold mb-2" x-text="t('training.userGuide')"></h4>
                            <p class="text-sm text-gray-600 mb-3" x-text="t('training.userGuideDesc')"></p>
                            <button class="text-blue-600 hover:text-blue-800 text-sm font-medium" x-text="t('training.openBtn') + ' ‚Üí'">
                            </button>
                        </div>
                        <div class="p-4 rounded-xl bg-gradient-to-r from-purple-50 to-pink-50">
                            <i class="fas fa-video text-purple-500 text-2xl mb-3"></i>
                            <h4 class="font-bold mb-2" x-text="t('training.videoTutorials')"></h4>
                            <p class="text-sm text-gray-600 mb-3" x-text="t('training.videoDesc')"></p>
                            <button class="text-purple-600 hover:text-purple-800 text-sm font-medium" x-text="t('training.watchBtn') + ' ‚Üí'">
                            </button>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- –ò—Å—Ç–æ—Ä–∏—è -->
            <div x-show="activeMenu === 'history'" x-cloak class="fade-in">
                <!-- –§–∏–ª—å—Ç—Ä—ã –∏—Å—Ç–æ—Ä–∏–∏ -->
                <div class="glass rounded-2xl p-5 mb-6">
                    <div class="flex items-center gap-4 flex-wrap">
                        <!-- –ü–æ–∏—Å–∫ –ø–æ –∞–Ω–∫–µ—Ç–µ -->
                        <div class="relative">
                            <i class="fas fa-search absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"></i>
                            <input type="text"
                                   class="glass pl-10 pr-4 py-2.5 rounded-xl w-48"
                                   placeholder="–ü–æ–∏—Å–∫ –ø–æ ID –∞–Ω–∫–µ—Ç—ã..."
                                   x-model="historyFilter.profileId"
                                   @keyup.enter="loadProfileHistory()">
                        </div>

                        <!-- –í—ã–±–æ—Ä –∞–¥–º–∏–Ω–∞ (—Ç–æ–ª—å–∫–æ –¥–ª—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∞) -->
                        <div x-show="currentUser.role === 'director'">
                            <select class="glass px-4 py-2.5 rounded-xl" x-model="historyFilter.admin">
                                <option value="" x-text="t('filters.allAdmins')"></option>
                                <template x-for="admin in admins" :key="admin.id">
                                    <option :value="admin.id" x-text="admin.name"></option>
                                </template>
                            </select>
                        </div>

                        <!-- –ö–∞–ª–µ–Ω–¥–∞—Ä—å (Flatpickr) -->
                        <div class="glass px-4 py-2.5 rounded-xl flex items-center">
                            <i class="fas fa-calendar mr-2 text-gray-400"></i>
                            <input type="text" id="historyDatePicker" class="bg-transparent border-none outline-none w-48 text-sm" readonly :placeholder="t('common.selectPeriod')">
                        </div>

                        <button @click="loadProfileHistory()" class="px-5 py-2.5 rounded-xl bg-indigo-500 text-white hover:bg-indigo-600 font-medium transition-all">
                            <i class="fas fa-sync-alt mr-2"></i><span x-text="t('common.refresh')"></span>
                        </button>
                    </div>
                </div>

                <div class="glass rounded-2xl p-6">
                    <h3 class="text-lg font-bold mb-6" x-text="t('history.title')"></h3>
                    <div class="overflow-x-auto">
                        <table class="w-full">
                            <thead>
                                <tr class="border-b border-gray-100">
                                    <th class="text-left py-2 px-4" x-text="t('history.dateCol')"></th>
                                    <th class="text-left py-2 px-4" x-text="t('history.profileCol')"></th>
                                    <th class="text-left py-2 px-4" x-text="t('history.actionCol')"></th>
                                    <th class="text-left py-2 px-4" x-text="t('history.byWhom')"></th>
                                    <th class="text-left py-2 px-4" x-text="t('history.detailsCol')"></th>
                                </tr>
                            </thead>
                            <tbody>
                                <template x-for="action in profileHistory" :key="action.id">
                                    <tr class="border-b border-gray-100 hover:bg-gray-50">
                                        <td class="py-3 px-4 text-sm" x-text="formatHistoryTime(action.created_at)"></td>
                                        <td class="py-3 px-4 font-mono" x-text="action.profile_id"></td>
                                        <td class="py-3 px-4">
                                            <span class="px-2 py-1 rounded-full text-xs"
                                                  :class="getProfileActionClass(action.action_type)"
                                                  x-text="getProfileActionLabel(action.action_type)"></span>
                                        </td>
                                        <td class="py-3 px-4 text-sm" x-text="action.performed_by || '-'"></td>
                                        <td class="py-3 px-4 text-sm text-gray-600" x-text="action.details || '-'"></td>
                                    </tr>
                                </template>
                                <tr x-show="profileHistory.length === 0">
                                    <td colspan="5" class="py-8 px-4 text-center text-gray-500">
                                        <i class="fas fa-history text-3xl mb-2 opacity-30"></i>
                                        <p x-text="t('history.noHistory')"></p>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- –§–∏–Ω–∞–Ω—Å—ã (—Ç–æ–ª—å–∫–æ –¥–ª—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∞) -->
            <div x-show="activeMenu === 'finances' && currentUser.role === 'director'" x-cloak class="fade-in">
                <!-- –§–æ—Ä–º–∞ –ø–æ–ø–æ–ª–Ω–µ–Ω–∏—è -->
                <div class="glass rounded-2xl p-6 mb-6">
                    <h3 class="text-lg font-bold mb-6">
                        <i class="fas fa-plus-circle text-green-500 mr-2"></i>
                        –ü–æ–ø–æ–ª–Ω–∏—Ç—å –±–∞–ª–∞–Ω—Å –∞–¥–º–∏–Ω–∞
                    </h3>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                        <!-- –í—ã–±–æ—Ä –∞–¥–º–∏–Ω–∞ -->
                        <div>
                            <label class="block text-sm font-medium mb-2">–í—ã–±–µ—Ä–∏—Ç–µ –∞–¥–º–∏–Ω–∞</label>
                            <select class="glass w-full px-4 py-3 rounded-xl" x-model="financeTopup.adminId">
                                <option value="">-- –í—ã–±–µ—Ä–∏—Ç–µ –∞–¥–º–∏–Ω–∞ --</option>
                                <template x-for="admin in financeAdmins" :key="admin.id">
                                    <option :value="admin.id">
                                        <span x-text="admin.name"></span> (–±–∞–ª–∞–Ω—Å: $<span x-text="admin.balance.toFixed(2)"></span>)
                                    </option>
                                </template>
                            </select>
                            <p x-show="financeAdmins.length === 0" class="text-sm text-gray-500 mt-1">
                                –ù–µ—Ç –∞–¥–º–∏–Ω–æ–≤ –¥–ª—è –ø–æ–ø–æ–ª–Ω–µ–Ω–∏—è (—Ç–æ–ª—å–∫–æ –∞–¥–º–∏–Ω—ã –±–µ–∑ –≥–∞–ª–æ—á–∫–∏ "–º–æ–π –∞–¥–º–∏–Ω")
                            </p>
                        </div>

                        <!-- –°—É–º–º–∞ -->
                        <div>
                            <label class="block text-sm font-medium mb-2">–°—É–º–º–∞ ($)</label>
                            <input type="number"
                                   class="glass w-full px-4 py-3 rounded-xl"
                                   min="1"
                                   step="1"
                                   placeholder="–í–≤–µ–¥–∏—Ç–µ —Å—É–º–º—É"
                                   x-model.number="financeTopup.amount">
                            <div class="flex gap-2 mt-2">
                                <button @click="financeTopup.amount = 5" class="px-3 py-1 text-xs bg-gray-100 rounded hover:bg-gray-200">$5</button>
                                <button @click="financeTopup.amount = 10" class="px-3 py-1 text-xs bg-gray-100 rounded hover:bg-gray-200">$10</button>
                                <button @click="financeTopup.amount = 20" class="px-3 py-1 text-xs bg-gray-100 rounded hover:bg-gray-200">$20</button>
                                <button @click="financeTopup.amount = 50" class="px-3 py-1 text-xs bg-gray-100 rounded hover:bg-gray-200">$50</button>
                                <button @click="financeTopup.amount = 100" class="px-3 py-1 text-xs bg-gray-100 rounded hover:bg-gray-200">$100</button>
                            </div>
                        </div>

                        <!-- –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ -->
                        <div>
                            <label class="block text-sm font-medium mb-2">–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)</label>
                            <input type="text"
                                   class="glass w-full px-4 py-3 rounded-xl"
                                   placeholder="–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –∫ –ø–æ–ø–æ–ª–Ω–µ–Ω–∏—é"
                                   x-model="financeTopup.note">
                        </div>
                    </div>

                    <div class="flex justify-end mt-6">
                        <button @click="submitFinanceTopup()"
                                :disabled="!financeTopup.adminId || !financeTopup.amount || financeTopup.amount <= 0"
                                class="glow-button px-6 py-3 rounded-xl text-white font-medium disabled:opacity-50 disabled:cursor-not-allowed">
                            <i class="fas fa-wallet mr-2"></i>
                            –ü–æ–ø–æ–ª–Ω–∏—Ç—å –±–∞–ª–∞–Ω—Å
                        </button>
                    </div>
                </div>

                <!-- –§–æ—Ä–º–∞ –æ–ø–ª–∞—Ç—ã –∞–Ω–∫–µ—Ç -->
                <div class="glass rounded-2xl p-6 mb-6">
                    <h3 class="text-lg font-bold mb-6">
                        <i class="fas fa-id-card text-blue-500 mr-2"></i>
                        –û–ø–ª–∞—Ç–∞ –∞–Ω–∫–µ—Ç
                    </h3>
                    <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                        <!-- ID –∞–Ω–∫–µ—Ç—ã -->
                        <div>
                            <label class="block text-sm font-medium mb-2">ID –∞–Ω–∫–µ—Ç—ã</label>
                            <input type="text"
                                   class="glass w-full px-4 py-3 rounded-xl"
                                   placeholder="–í–≤–µ–¥–∏—Ç–µ ID –∞–Ω–∫–µ—Ç—ã: 123456"
                                   x-model="profilePayment.profileId">
                            <p class="text-xs text-gray-500 mt-1">ID –ø—Ä–æ—Ñ–∏–ª—è –¥–ª—è –æ–ø–ª–∞—Ç—ã</p>
                        </div>

                        <!-- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–Ω–µ–π -->
                        <div>
                            <label class="block text-sm font-medium mb-2">–ü–µ—Ä–∏–æ–¥ –æ–ø–ª–∞—Ç—ã</label>
                            <div class="flex gap-2">
                                <button @click="profilePayment.days = 15"
                                        class="flex-1 px-3 py-3 rounded-xl text-sm font-medium transition-colors"
                                        :class="profilePayment.days === 15 ? 'bg-indigo-500 text-white' : 'bg-gray-100 hover:bg-gray-200'">
                                    15 –¥–Ω–µ–π
                                </button>
                                <button @click="profilePayment.days = 30"
                                        class="flex-1 px-3 py-3 rounded-xl text-sm font-medium transition-colors"
                                        :class="profilePayment.days === 30 ? 'bg-indigo-500 text-white' : 'bg-gray-100 hover:bg-gray-200'">
                                    30 –¥–Ω–µ–π
                                </button>
                                <button @click="profilePayment.days = 45"
                                        class="flex-1 px-3 py-3 rounded-xl text-sm font-medium transition-colors"
                                        :class="profilePayment.days === 45 ? 'bg-indigo-500 text-white' : 'bg-gray-100 hover:bg-gray-200'">
                                    45 –¥–Ω–µ–π
                                </button>
                                <button @click="profilePayment.days = 60"
                                        class="flex-1 px-3 py-3 rounded-xl text-sm font-medium transition-colors"
                                        :class="profilePayment.days === 60 ? 'bg-indigo-500 text-white' : 'bg-gray-100 hover:bg-gray-200'">
                                    60 –¥–Ω–µ–π
                                </button>
                            </div>
                        </div>

                        <!-- –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ -->
                        <div>
                            <label class="block text-sm font-medium mb-2">–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ</label>
                            <input type="text"
                                   class="glass w-full px-4 py-3 rounded-xl"
                                   placeholder="–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π"
                                   x-model="profilePayment.note">
                        </div>

                        <!-- –ö–Ω–æ–ø–∫–∏ -->
                        <div class="flex items-end gap-2">
                            <button @click="submitProfilePayment()"
                                    :disabled="!profilePayment.profileId.trim() || !profilePayment.days"
                                    class="flex-1 glow-button px-4 py-3 rounded-xl text-white font-medium disabled:opacity-50 disabled:cursor-not-allowed">
                                <i class="fas fa-credit-card mr-2"></i>–û–ø–ª–∞—Ç–∏—Ç—å
                            </button>
                            <button @click="removeProfilePayment()"
                                    :disabled="!profilePayment.profileId.trim()"
                                    class="px-4 py-3 rounded-xl bg-red-500 hover:bg-red-600 text-white font-medium disabled:opacity-50 disabled:cursor-not-allowed"
                                    title="–£–±—Ä–∞—Ç—å –æ–ø–ª–∞—Ç—É —Å –∞–Ω–∫–µ—Ç—ã">
                                <i class="fas fa-times"></i>
                            </button>
                        </div>
                    </div>
                </div>

                <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏ –∏—Å—Ç–æ—Ä–∏—è -->
                <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-6">
                    <div class="glass rounded-2xl p-6 text-center">
                        <div class="text-3xl font-bold text-green-600">$<span x-text="financeTotalSum.toFixed(2)"></span></div>
                        <div class="text-sm text-gray-500 mt-1">–í—Å–µ–≥–æ –ø–æ–ø–æ–ª–Ω–µ–Ω–æ</div>
                    </div>
                    <div class="glass rounded-2xl p-6 text-center">
                        <div class="text-3xl font-bold text-blue-600" x-text="financeHistory.length"></div>
                        <div class="text-sm text-gray-500 mt-1">–¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–π</div>
                    </div>
                    <div class="glass rounded-2xl p-6 text-center">
                        <div class="text-3xl font-bold text-purple-600" x-text="financeAdmins.length"></div>
                        <div class="text-sm text-gray-500 mt-1">–ê–¥–º–∏–Ω–æ–≤ —Å –±–∞–ª–∞–Ω—Å–æ–º</div>
                    </div>
                    <div class="glass rounded-2xl p-6 text-center">
                        <div class="text-3xl font-bold text-orange-600">$<span x-text="financeAdminsTotalBalance.toFixed(2)"></span></div>
                        <div class="text-sm text-gray-500 mt-1">–û–±—â–∏–π –±–∞–ª–∞–Ω—Å –∞–¥–º–∏–Ω–æ–≤</div>
                    </div>
                </div>

                <!-- –û–±—ä–µ–¥–∏–Ω–µ–Ω–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ –∏—Å—Ç–æ—Ä–∏–∏ -->
                <div class="glass rounded-2xl p-6">
                    <div class="flex items-center justify-between mb-6">
                        <h3 class="text-lg font-bold">
                            <i class="fas fa-history text-gray-500 mr-2"></i>
                            –ò—Å—Ç–æ—Ä–∏—è –æ–ø–µ—Ä–∞—Ü–∏–π
                        </h3>
                        <button @click="loadFinanceData()" class="px-5 py-2.5 rounded-xl bg-gray-100 hover:bg-gray-200 text-sm font-medium transition-all">
                            <i class="fas fa-sync-alt mr-1"></i> –û–±–Ω–æ–≤–∏—Ç—å
                        </button>
                    </div>

                    <div class="overflow-x-auto">
                        <table class="w-full">
                            <thead>
                                <tr class="border-b border-gray-100">
                                    <th class="text-left py-3 px-4">–î–∞—Ç–∞</th>
                                    <th class="text-left py-3 px-4">–¢–∏–ø</th>
                                    <th class="text-left py-3 px-4">–û–±—ä–µ–∫—Ç</th>
                                    <th class="text-left py-3 px-4">–î–µ—Ç–∞–ª–∏</th>
                                    <th class="text-left py-3 px-4">–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ</th>
                                </tr>
                            </thead>
                            <tbody>
                                <template x-for="item in combinedFinanceHistory" :key="item.uniqueId">
                                    <tr class="border-b border-gray-100 hover:bg-gray-50">
                                        <td class="py-3 px-4 text-sm" x-text="formatDateTime(item.createdAt)"></td>
                                        <td class="py-3 px-4">
                                            <span x-show="item.type === 'topup'" class="px-2 py-1 bg-green-100 text-green-600 rounded text-xs font-medium">
                                                <i class="fas fa-wallet mr-1"></i>–ü–æ–ø–æ–ª–Ω–µ–Ω–∏–µ
                                            </span>
                                            <span x-show="item.type === 'profile_payment'" class="px-2 py-1 bg-blue-100 text-blue-600 rounded text-xs font-medium">
                                                <i class="fas fa-id-card mr-1"></i>–û–ø–ª–∞—Ç–∞ –∞–Ω–∫–µ—Ç—ã
                                            </span>
                                            <span x-show="item.type === 'profile_removal'" class="px-2 py-1 bg-red-100 text-red-600 rounded text-xs font-medium">
                                                <i class="fas fa-times mr-1"></i>–°–Ω—è—Ç–∏–µ –æ–ø–ª–∞—Ç—ã
                                            </span>
                                        </td>
                                        <td class="py-3 px-4">
                                            <!-- –î–ª—è –ø–æ–ø–æ–ª–Ω–µ–Ω–∏—è - –∏–º—è –∞–¥–º–∏–Ω–∞ -->
                                            <span x-show="item.type === 'topup'" class="font-medium" x-text="item.adminName"></span>
                                            <!-- –î–ª—è –æ–ø–ª–∞—Ç—ã –∞–Ω–∫–µ—Ç—ã - ID –∞–Ω–∫–µ—Ç—ã -->
                                            <span x-show="item.type !== 'topup'" class="font-mono font-medium"><span x-text="item.profileId"></span></span>
                                        </td>
                                        <td class="py-3 px-4">
                                            <!-- –î–ª—è –ø–æ–ø–æ–ª–Ω–µ–Ω–∏—è - —Å—É–º–º–∞ –∏ –±–∞–ª–∞–Ω—Å -->
                                            <template x-if="item.type === 'topup'">
                                                <div>
                                                    <span class="text-green-600 font-semibold">+$<span x-text="item.amount?.toFixed(2)"></span></span>
                                                    <span class="text-gray-400 mx-1">‚Üí</span>
                                                    <span class="text-blue-600">$<span x-text="item.adminBalance?.toFixed(2)"></span></span>
                                                </div>
                                            </template>
                                            <!-- –î–ª—è –æ–ø–ª–∞—Ç—ã –∞–Ω–∫–µ—Ç—ã - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–Ω–µ–π -->
                                            <template x-if="item.type === 'profile_payment'">
                                                <span class="text-blue-600 font-semibold" x-text="item.days + ' –¥–Ω–µ–π'"></span>
                                            </template>
                                            <template x-if="item.type === 'profile_removal'">
                                                <span class="text-gray-400">–û–ø–ª–∞—Ç–∞ —Å–Ω—è—Ç–∞</span>
                                            </template>
                                        </td>
                                        <td class="py-3 px-4 text-sm text-gray-500" x-text="item.note || '-'"></td>
                                    </tr>
                                </template>
                                <tr x-show="combinedFinanceHistory.length === 0">
                                    <td colspan="5" class="py-8 px-4 text-center text-gray-500">
                                        <i class="fas fa-history text-3xl mb-2 opacity-30"></i>
                                        <p>–ò—Å—Ç–æ—Ä–∏—è –æ–ø–µ—Ä–∞—Ü–∏–π –ø—É—Å—Ç–∞</p>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∞–Ω–∫–µ—Ç—ã -->
    <div x-show="showAddAccountModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4">
        <div class="glass rounded-2xl p-6 w-full max-w-2xl" @click.outside="showAddAccountModal = false">
            <div class="flex justify-between items-center mb-6">
                <h3 class="text-xl font-bold" x-text="t('modals.addProfiles.title')"></h3>
                <button @click="showAddAccountModal = false" class="text-gray-500 hover:text-gray-700">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div class="space-y-4">
                <div>
                    <label class="block text-sm font-medium mb-2">ID –∞–Ω–∫–µ—Ç (6 —Ü–∏—Ñ—Ä)</label>
                    <textarea 
                        class="glass w-full px-4 py-3 rounded-xl"
                        placeholder="–í–≤–µ–¥–∏—Ç–µ ID —á–µ—Ä–µ–∑ –ø—Ä–æ–±–µ–ª –∏–ª–∏ –∑–∞–ø—è—Ç—É—é: 123456 234567 345678"
                        rows="3"
                        x-model="newAccountIds"></textarea>
                    <p class="text-sm text-gray-500 mt-1">–ú–æ–∂–Ω–æ –≤–≤–µ—Å—Ç–∏ –Ω–µ—Å–∫–æ–ª—å–∫–æ ID —á–µ—Ä–µ–∑ –ø—Ä–æ–±–µ–ª –∏–ª–∏ –∑–∞–ø—è—Ç—É—é</p>
                </div>
                
                <div>
                    <label class="block text-sm font-medium mb-2">–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π</label>
                    <input type="text"
                           class="glass w-full px-4 py-3 rounded-xl"
                           placeholder="–û–±—â–∏–π –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –¥–ª—è –≤—Å–µ—Ö –∞–Ω–∫–µ—Ç"
                           x-model="newAccountComment">
                </div>

                <!-- –ù–∞–∑–Ω–∞—á–∏—Ç—å –∫–æ–º—É (—Ç–æ–ª—å–∫–æ –¥–ª—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∞) -->
                <div x-show="currentUser.role === 'director'">
                    <label class="block text-sm font-medium mb-2">–ù–∞–∑–Ω–∞—á–∏—Ç—å –∫–æ–º—É (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)</label>
                    <select x-model="newAccountAssignTo" class="glass w-full px-4 py-3 rounded-xl">
                        <option value="">‚Äî –ù–µ –Ω–∞–∑–Ω–∞—á–∞—Ç—å ‚Äî</option>
                        <optgroup label="–ê–¥–º–∏–Ω—ã">
                            <template x-for="admin in admins" :key="'admin_' + admin.id">
                                <option :value="'admin_' + admin.id" x-text="admin.name"></option>
                            </template>
                        </optgroup>
                        <optgroup label="–ü–µ—Ä–µ–≤–æ–¥—á–∏–∫–∏">
                            <template x-for="translator in allTranslators" :key="'translator_' + translator.id">
                                <option :value="'translator_' + translator.id" x-text="translator.name + (translator.adminName ? ' (' + translator.adminName + ')' : '')"></option>
                            </template>
                        </optgroup>
                    </select>
                    <p class="text-sm text-gray-500 mt-1">–í—ã–±–µ—Ä–∏—Ç–µ –∞–¥–º–∏–Ω–∞ –∏–ª–∏ –ø–µ—Ä–µ–≤–æ–¥—á–∏–∫–∞ –¥–ª—è –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è –∞–Ω–∫–µ—Ç</p>
                </div>

                <div class="flex justify-end space-x-3 pt-4">
                    <button @click="showAddAccountModal = false" class="px-5 py-2.5 rounded-xl hover:bg-gray-100 font-medium transition-all">
                        –û—Ç–º–µ–Ω–∞
                    </button>
                    <button @click="saveAccounts" class="glow-button px-5 py-2.5 rounded-xl text-white font-medium">
                        –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∞–Ω–∫–µ—Ç—ã
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∞–¥–º–∏–Ω–∞ -->
    <div x-show="showAddAdminModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4">
        <div class="glass rounded-2xl p-6 w-full max-w-md" @click.outside="showAddAdminModal = false">
            <div class="flex justify-between items-center mb-6">
                <h3 class="text-xl font-bold" x-text="newAdmin.id ? '–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞' : '–î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞'"></h3>
                <button @click="showAddAdminModal = false" class="text-gray-500 hover:text-gray-700">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div class="space-y-4">
                <div>
                    <label class="block text-sm font-medium mb-2">–ò–º—è</label>
                    <input type="text" 
                           class="glass w-full px-4 py-3 rounded-xl"
                           placeholder="–í–≤–µ–¥–∏—Ç–µ –∏–º—è"
                           x-model="newAdmin.name">
                </div>
                
                <div>
                    <label class="block text-sm font-medium mb-2">–õ–æ–≥–∏–Ω</label>
                    <input type="text" 
                           class="glass w-full px-4 py-3 rounded-xl"
                           placeholder="–í–≤–µ–¥–∏—Ç–µ –ª–æ–≥–∏–Ω"
                           x-model="newAdmin.login">
                </div>
                
                <div>
                    <label class="block text-sm font-medium mb-2">–ü–∞—Ä–æ–ª—å</label>
                    <input type="password" 
                           class="glass w-full px-4 py-3 rounded-xl"
                           placeholder="–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å"
                           x-model="newAdmin.password">
                </div>
                
                <div class="flex items-center">
                    <input type="checkbox"
                           id="myAdminCheckbox"
                           class="rounded"
                           x-model="newAdmin.isMyAdmin"
                           @change="newAdmin.salary = ''">
                    <label for="myAdminCheckbox" class="ml-2 text-sm" x-text="t('modals.addAdmin.myAdminLabel')">
                    </label>
                </div>

                <div class="flex items-center">
                    <input type="checkbox"
                           id="aiEnabledCheckbox"
                           class="rounded"
                           x-model="newAdmin.aiEnabled">
                    <label for="aiEnabledCheckbox" class="ml-2 text-sm">
                        <i class="fas fa-brain text-orange-500 mr-1"></i>
                        <span x-text="t('team.aiEnabled')"></span>
                    </label>
                </div>

                <div x-show="!newAdmin.isMyAdmin">
                    <label class="block text-sm font-medium mb-2">–°—É–º–º–∞</label>
                    <input type="number"
                           class="glass w-full px-4 py-3 rounded-xl"
                           placeholder="–í–≤–µ–¥–∏—Ç–µ —Å—É–º–º—É"
                           x-model="newAdmin.salary">
                </div>

                <div>
                    <label class="block text-sm font-medium mb-2">ID –∞–Ω–∫–µ—Ç (—á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é –∏–ª–∏ —Å –Ω–æ–≤–æ–π —Å—Ç—Ä–æ–∫–∏)</label>
                    <textarea class="glass w-full px-4 py-3 rounded-xl resize-none"
                              rows="3"
                              placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: 123456, 789012&#10;–∏–ª–∏ –∫–∞–∂–¥—ã–π ID —Å –Ω–æ–≤–æ–π —Å—Ç—Ä–æ–∫–∏"
                              x-model="newAdmin.profileIds"></textarea>
                    <p class="text-xs text-gray-500 mt-1">–û—Å—Ç–∞–≤—å—Ç–µ –ø—É—Å—Ç—ã–º, —á—Ç–æ–±—ã –Ω–µ –Ω–∞–∑–Ω–∞—á–∞—Ç—å –∞–Ω–∫–µ—Ç—ã —Å–µ–π—á–∞—Å</p>
                </div>

                <div class="flex justify-end space-x-3 pt-4">
                    <button @click="showAddAdminModal = false" class="px-5 py-2.5 rounded-xl hover:bg-gray-100 font-medium transition-all">
                        –û—Ç–º–µ–Ω–∞
                    </button>
                    <button @click="saveAdmin" class="glow-button px-5 py-2.5 rounded-xl text-white font-medium">
                        –°–æ—Ö—Ä–∞–Ω–∏—Ç—å
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –ø–µ—Ä–µ–≤–æ–¥—á–∏–∫–∞ -->
    <div x-show="showAddTranslatorModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4">
        <div class="glass rounded-2xl p-6 w-full max-w-md" @click.outside="showAddTranslatorModal = false">
            <div class="flex justify-between items-center mb-6">
                <h3 class="text-xl font-bold" x-text="newTranslator.id ? '–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–µ—Ä–µ–≤–æ–¥—á–∏–∫–∞' : '–î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø–µ—Ä–µ–≤–æ–¥—á–∏–∫–∞'"></h3>
                <button @click="showAddTranslatorModal = false" class="text-gray-500 hover:text-gray-700">
                    <i class="fas fa-times"></i>
                </button>
            </div>

            <div class="space-y-4">
                <!-- –í—ã–±–æ—Ä –∞–¥–º–∏–Ω–∞ (—Ç–æ–ª—å–∫–æ –¥–ª—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∞) -->
                <div x-show="currentUser.role === 'director'">
                    <label class="block text-sm font-medium mb-2">–ê–¥–º–∏–Ω</label>
                    <select class="glass w-full px-4 py-3 rounded-xl" x-model="newTranslator.adminId">
                        <option value="">-- –í—ã–±–µ—Ä–∏—Ç–µ –∞–¥–º–∏–Ω–∞ --</option>
                        <template x-for="admin in admins" :key="admin.id">
                            <option :value="admin.id" x-text="admin.name"></option>
                        </template>
                    </select>
                </div>

                <div>
                    <label class="block text-sm font-medium mb-2">–ò–º—è</label>
                    <input type="text"
                           class="glass w-full px-4 py-3 rounded-xl"
                           placeholder="–í–≤–µ–¥–∏—Ç–µ –∏–º—è"
                           x-model="newTranslator.name">
                </div>

                <div>
                    <label class="block text-sm font-medium mb-2">–õ–æ–≥–∏–Ω</label>
                    <input type="text"
                           class="glass w-full px-4 py-3 rounded-xl"
                           placeholder="–í–≤–µ–¥–∏—Ç–µ –ª–æ–≥–∏–Ω"
                           x-model="newTranslator.login">
                </div>

                <div>
                    <label class="block text-sm font-medium mb-2">–ü–∞—Ä–æ–ª—å</label>
                    <input type="password"
                           class="glass w-full px-4 py-3 rounded-xl"
                           placeholder="–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å"
                           x-model="newTranslator.password">
                </div>

                <div class="flex items-center">
                    <input type="checkbox"
                           id="translatorAiEnabledCheckbox"
                           class="rounded"
                           x-model="newTranslator.aiEnabled">
                    <label for="translatorAiEnabledCheckbox" class="ml-2 text-sm">
                        <i class="fas fa-brain text-orange-500 mr-1"></i>
                        –†–∞—Å—à–∏—Ä–∏—Ç—å AI
                    </label>
                </div>

                <div>
                    <label class="block text-sm font-medium mb-2">–°—Ç–∞–≤–∫–∞</label>
                    <input type="number"
                           class="glass w-full px-4 py-3 rounded-xl"
                           placeholder="–í–≤–µ–¥–∏—Ç–µ —Å—Ç–∞–≤–∫—É"
                           x-model="newTranslator.salary">
                </div>

                <div class="flex justify-end space-x-3 pt-4">
                    <button @click="showAddTranslatorModal = false" class="px-5 py-2.5 rounded-xl hover:bg-gray-100 font-medium transition-all">
                        –û—Ç–º–µ–Ω–∞
                    </button>
                    <button @click="saveTranslator" class="glow-button px-5 py-2.5 rounded-xl text-white font-medium">
                        –°–æ—Ö—Ä–∞–Ω–∏—Ç—å
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∞–Ω–∫–µ—Ç –∞–¥–º–∏–Ω—É -->
    <div x-show="showAssignAccountsModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4">
        <div class="glass rounded-2xl p-6 w-full max-w-2xl max-h-[90vh] overflow-y-auto" @click.outside="showAssignAccountsModal = false">
            <div class="flex justify-between items-center mb-6">
                <h3 class="text-xl font-bold">–ê–Ω–∫–µ—Ç—ã –¥–ª—è <span x-text="selectedAdmin?.name"></span></h3>
                <button @click="showAssignAccountsModal = false" class="text-gray-500 hover:text-gray-700">
                    <i class="fas fa-times"></i>
                </button>
            </div>

            <div class="space-y-4">
                <!-- –í—ã–±–æ—Ä –∏–∑ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –∞–Ω–∫–µ—Ç -->
                <div>
                    <label class="block text-sm font-medium mb-2">–í—ã–±—Ä–∞—Ç—å –∏–∑ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –∞–Ω–∫–µ—Ç</label>
                    <div class="glass rounded-xl p-3 max-h-48 overflow-y-auto">
                        <div class="space-y-2">
                            <template x-for="account in accounts.filter(a => !a.admin || a.admin === '')" :key="account.id">
                                <label class="flex items-center p-2 rounded-lg hover:bg-gray-50 cursor-pointer">
                                    <input type="checkbox"
                                           :value="account.id"
                                           x-model="selectedAccountIds"
                                           class="rounded mr-3">
                                    <span class="font-mono text-sm font-medium" x-text="account.id"></span>
                                </label>
                            </template>
                            <div x-show="accounts.filter(a => !a.admin || a.admin === '').length === 0" class="text-center text-gray-500 py-4">
                                –ù–µ—Ç —Å–≤–æ–±–æ–¥–Ω—ã—Ö –∞–Ω–∫–µ—Ç
                            </div>
                        </div>
                    </div>
                    <p class="text-sm text-gray-500 mt-1">–í—ã–±—Ä–∞–Ω–æ: <span x-text="selectedAccountIds.length"></span> –∞–Ω–∫–µ—Ç</p>
                </div>

                <div class="border-t border-gray-200 pt-4">
                    <label class="block text-sm font-medium mb-2">–ò–ª–∏ –≤–≤–µ–¥–∏—Ç–µ ID –≤—Ä—É—á–Ω—É—é</label>
                    <textarea
                        class="glass w-full px-4 py-3 rounded-xl"
                        placeholder="–í–≤–µ–¥–∏—Ç–µ ID –∞–Ω–∫–µ—Ç —á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é: 123456, 234567"
                        rows="2"
                        x-model="accountsToAssign"></textarea>
                </div>

                <div>
                    <label class="block text-sm font-medium mb-2">–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π</label>
                    <input type="text"
                           class="glass w-full px-4 py-3 rounded-xl"
                           placeholder="–û–±—â–∏–π –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π"
                           x-model="assignComment">
                </div>

                <div class="flex justify-end space-x-3 pt-4">
                    <button @click="showAssignAccountsModal = false" class="px-5 py-2.5 rounded-xl hover:bg-gray-100 font-medium transition-all">
                        –û—Ç–º–µ–Ω–∞
                    </button>
                    <button @click="assignAccountsToAdminConfirm" class="glow-button px-5 py-2.5 rounded-xl text-white font-medium">
                        –ù–∞–∑–Ω–∞—á–∏—Ç—å
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è –∞–Ω–∫–µ—Ç –ø–µ—Ä–µ–≤–æ–¥—á–∏–∫—É -->
    <div x-show="showTranslatorProfilesModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4">
        <div class="glass rounded-2xl p-6 w-full max-w-2xl max-h-[90vh] overflow-y-auto" @click.outside="showTranslatorProfilesModal = false">
            <div class="flex justify-between items-center mb-6">
                <h3 class="text-xl font-bold">
                    <i class="fas fa-user-tag text-indigo-500 mr-2"></i>
                    –ê–Ω–∫–µ—Ç—ã –¥–ª—è <span x-text="selectedTranslatorForProfiles?.name"></span>
                </h3>
                <button @click="showTranslatorProfilesModal = false" class="text-gray-500 hover:text-gray-700">
                    <i class="fas fa-times"></i>
                </button>
            </div>

            <div class="mb-4 p-3 bg-indigo-50 rounded-lg text-sm text-indigo-700">
                <i class="fas fa-info-circle mr-2"></i>
                –í—ã–±–µ—Ä–∏—Ç–µ –∞–Ω–∫–µ—Ç—ã, –∫–æ—Ç–æ—Ä—ã–µ –±—É–¥—É—Ç –¥–æ—Å—Ç—É–ø–Ω—ã –ø–µ—Ä–µ–≤–æ–¥—á–∏–∫—É –¥–ª—è —Ä–∞–±–æ—Ç—ã
            </div>

            <!-- –°–ø–∏—Å–æ–∫ –∞–Ω–∫–µ—Ç -->
            <div class="space-y-2 max-h-96 overflow-y-auto mb-4">
                <template x-for="account in accounts" :key="account.id">
                    <label class="flex items-center p-3 rounded-lg hover:bg-gray-50 cursor-pointer border border-gray-100"
                           :class="{ 'bg-indigo-50 border-indigo-200': selectedTranslatorProfileIds.includes(String(account.id)) }">
                        <input type="checkbox"
                               class="profile-checkbox mr-3"
                               :checked="selectedTranslatorProfileIds.includes(String(account.id))"
                               @change="toggleTranslatorProfile(account.id)">
                        <div class="flex-1">
                            <div class="font-medium" x-text="'#' + account.id"></div>
                            <div class="text-xs text-gray-500">
                                <span :class="account.status === 'online' ? 'text-green-500' : 'text-gray-400'"
                                      x-text="account.status === 'online' ? '–û–Ω–ª–∞–π–Ω' : '–û—Ñ—Ñ–ª–∞–π–Ω'"></span>
                                <span class="mx-1">‚Ä¢</span>
                                <span x-text="account.incoming || 0"></span> –≤—Ö–æ–¥—è—â–∏—Ö
                            </div>
                        </div>
                    </label>
                </template>
            </div>

            <div class="text-sm text-gray-500 mb-4">
                –í—ã–±—Ä–∞–Ω–æ: <span class="font-medium text-indigo-600" x-text="selectedTranslatorProfileIds.length"></span> –∞–Ω–∫–µ—Ç
            </div>

            <div class="flex justify-end space-x-3 pt-4 border-t border-gray-100">
                <button @click="showTranslatorProfilesModal = false" class="px-5 py-2.5 rounded-xl hover:bg-gray-100 font-medium transition-all">
                    –û—Ç–º–µ–Ω–∞
                </button>
                <button @click="saveTranslatorProfiles" class="glow-button px-5 py-2.5 rounded-xl text-white font-medium">
                    <i class="fas fa-save mr-2"></i>–°–æ—Ö—Ä–∞–Ω–∏—Ç—å
                </button>
            </div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –¥–µ—Ç–∞–ª–µ–π –∞–¥–º–∏–Ω–∞ -->
    <div x-show="showViewAdminModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4">
        <div class="glass rounded-2xl p-6 w-full max-w-2xl" @click.outside="showViewAdminModal = false">
            <div class="flex justify-between items-center mb-6">
                <h3 class="text-xl font-bold">–î–µ—Ç–∞–ª–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞: <span x-text="selectedAdmin?.name"></span></h3>
                <button @click="showViewAdminModal = false" class="text-gray-500 hover:text-gray-700">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div class="space-y-6">
                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <div class="text-sm text-gray-600">–õ–æ–≥–∏–Ω:</div>
                        <div class="font-medium" x-text="selectedAdmin?.login"></div>
                    </div>
                    <div>
                        <div class="text-sm text-gray-600">–ü–∞—Ä–æ–ª—å:</div>
                        <div class="font-medium font-mono" x-text="selectedAdmin?.password"></div>
                    </div>
                </div>
                
                <div>
                    <div class="text-sm text-gray-600 mb-2">–ü–µ—Ä–µ–≤–æ–¥—á–∏–∫–∏:</div>
                    <div class="space-y-3">
                        <template x-for="translator in selectedAdmin?.translators" :key="translator.id">
                            <div class="glass p-4 rounded-xl">
                                <div class="flex justify-between items-center mb-2">
                                    <div class="font-medium" x-text="translator.name"></div>
                                    <div class="text-sm text-green-600" x-text="translator.conversion + '% –∫–æ–Ω–≤–µ—Ä—Å–∏—è'"></div>
                                </div>
                                <div class="text-sm text-gray-600">
                                    –õ–æ–≥–∏–Ω: <span x-text="translator.login"></span> | 
                                    –ü–∞—Ä–æ–ª—å: <span x-text="translator.password"></span>
                                </div>
                                <div class="text-sm text-gray-600 mt-2">
                                    –ê–Ω–∫–µ—Ç—ã: <span x-text="translator.accounts.join(', ') || '–Ω–µ—Ç'"></span>
                                </div>
                            </div>
                        </template>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –ø—Ä–æ–¥–ª–µ–Ω–∏—è –∞–Ω–∫–µ—Ç—ã -->
    <div x-show="showExtendModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4">
        <div class="glass rounded-2xl p-6 w-full max-w-md" @click.outside="showExtendModal = false">
            <div class="flex justify-between items-center mb-6">
                <h3 class="text-xl font-bold">–ü—Ä–æ–¥–ª–∏—Ç—å –∞–Ω–∫–µ—Ç—É</h3>
                <button @click="showExtendModal = false" class="text-gray-500 hover:text-gray-700">
                    <i class="fas fa-times"></i>
                </button>
            </div>

            <div class="space-y-4">
                <div class="text-center mb-4">
                    <div class="text-lg font-medium text-gray-700">
                        –ê–Ω–∫–µ—Ç–∞: <span class="text-indigo-600 font-mono" x-text="extendingProfile?.profile_id"></span>
                    </div>
                    <div class="text-sm text-gray-500 mt-1">
                        –¢–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å: <span :class="getPaymentStatusClass(extendingProfile || {})" x-text="getPaymentStatusText(extendingProfile || {})"></span>
                    </div>
                </div>

                <div>
                    <label class="block text-sm font-medium mb-3">–í—ã–±–µ—Ä–∏—Ç–µ –ø–µ—Ä–∏–æ–¥:</label>
                    <div class="grid grid-cols-2 gap-3">
                        <button @click="selectedDays = 15"
                                class="p-4 rounded-xl border-2 transition-all"
                                :class="selectedDays === 15 ? 'border-indigo-500 bg-indigo-50' : 'border-gray-200 hover:border-gray-300'">
                            <div class="font-semibold">15 –¥–Ω–µ–π</div>
                            <div class="text-green-600 font-medium">$1</div>
                        </button>
                        <button @click="selectedDays = 30"
                                class="p-4 rounded-xl border-2 transition-all"
                                :class="selectedDays === 30 ? 'border-indigo-500 bg-indigo-50' : 'border-gray-200 hover:border-gray-300'">
                            <div class="font-semibold">30 –¥–Ω–µ–π</div>
                            <div class="text-green-600 font-medium">$2</div>
                        </button>
                        <button @click="selectedDays = 45"
                                class="p-4 rounded-xl border-2 transition-all"
                                :class="selectedDays === 45 ? 'border-indigo-500 bg-indigo-50' : 'border-gray-200 hover:border-gray-300'">
                            <div class="font-semibold">45 –¥–Ω–µ–π</div>
                            <div class="text-green-600 font-medium">$3</div>
                        </button>
                        <button @click="selectedDays = 60"
                                class="p-4 rounded-xl border-2 transition-all"
                                :class="selectedDays === 60 ? 'border-indigo-500 bg-indigo-50' : 'border-gray-200 hover:border-gray-300'">
                            <div class="font-semibold">60 –¥–Ω–µ–π</div>
                            <div class="text-green-600 font-medium">$4</div>
                        </button>
                    </div>
                </div>

                <div class="bg-gray-50 rounded-xl p-4 mt-4">
                    <div class="flex justify-between items-center">
                        <span class="text-gray-600">–ö –æ–ø–ª–∞—Ç–µ:</span>
                        <span class="text-2xl font-bold text-green-600">$<span x-text="pricing[selectedDays] || 0"></span></span>
                    </div>
                    <div class="flex justify-between items-center mt-2 text-sm">
                        <span class="text-gray-500">–í–∞—à –±–∞–ª–∞–Ω—Å:</span>
                        <span :class="userBalance >= (pricing[selectedDays] || 0) ? 'text-green-600' : 'text-red-500'">
                            $<span x-text="userBalance.toFixed(2)"></span>
                        </span>
                    </div>
                </div>

                <div class="flex justify-end space-x-3 pt-4">
                    <button @click="showExtendModal = false" class="px-5 py-2.5 rounded-xl hover:bg-gray-100 font-medium transition-all">
                        –û—Ç–º–µ–Ω–∞
                    </button>
                    <button @click="extendProfile"
                            :disabled="userBalance < (pricing[selectedDays] || 0)"
                            class="glow-button px-5 py-2.5 rounded-xl text-white font-medium disabled:opacity-50 disabled:cursor-not-allowed">
                        –û–ø–ª–∞—Ç–∏—Ç—å
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –ø–æ–ø–æ–ª–Ω–µ–Ω–∏—è –±–∞–ª–∞–Ω—Å–∞ (–¥–ª—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∞) -->
    <div x-show="showTopupModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4">
        <div class="glass rounded-2xl p-6 w-full max-w-md" @click.outside="showTopupModal = false">
            <div class="flex justify-between items-center mb-6">
                <h3 class="text-xl font-bold">–ü–æ–ø–æ–ª–Ω–∏—Ç—å –±–∞–ª–∞–Ω—Å</h3>
                <button @click="showTopupModal = false" class="text-gray-500 hover:text-gray-700">
                    <i class="fas fa-times"></i>
                </button>
            </div>

            <div class="space-y-4">
                <div>
                    <label class="block text-sm font-medium mb-2">–°—É–º–º–∞ –ø–æ–ø–æ–ª–Ω–µ–Ω–∏—è ($)</label>
                    <input type="number"
                           class="glass w-full px-4 py-3 rounded-xl"
                           min="1"
                           step="1"
                           placeholder="–í–≤–µ–¥–∏—Ç–µ —Å—É–º–º—É"
                           x-model.number="topupAmount">
                </div>

                <div class="grid grid-cols-4 gap-2">
                    <button @click="topupAmount = 5" class="py-2 px-3 rounded-lg bg-gray-100 hover:bg-gray-200 text-sm">$5</button>
                    <button @click="topupAmount = 10" class="py-2 px-3 rounded-lg bg-gray-100 hover:bg-gray-200 text-sm">$10</button>
                    <button @click="topupAmount = 20" class="py-2 px-3 rounded-lg bg-gray-100 hover:bg-gray-200 text-sm">$20</button>
                    <button @click="topupAmount = 50" class="py-2 px-3 rounded-lg bg-gray-100 hover:bg-gray-200 text-sm">$50</button>
                </div>

                <div class="flex justify-end space-x-3 pt-4">
                    <button @click="showTopupModal = false" class="px-5 py-2.5 rounded-xl hover:bg-gray-100 font-medium transition-all">
                        –û—Ç–º–µ–Ω–∞
                    </button>
                    <button @click="topupBalance" class="glow-button px-5 py-2.5 rounded-xl text-white font-medium">
                        –ü–æ–ø–æ–ª–Ω–∏—Ç—å
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –Ω–∞—Å—Ç—Ä–æ–µ–∫ -->
    <div x-show="showSettingsModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4">
        <div class="glass rounded-2xl p-6 w-full max-w-lg" @click.outside="showSettingsModal = false">
            <div class="flex justify-between items-center mb-6">
                <h3 class="text-xl font-bold">–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–æ—Ñ–∏–ª—è</h3>
                <button @click="showSettingsModal = false" class="text-gray-500 hover:text-gray-700">
                    <i class="fas fa-times"></i>
                </button>
            </div>

            <div class="space-y-5">
                <!-- –ê–≤–∞—Ç–∞—Ä -->
                <div class="flex items-center space-x-4">
                    <div class="w-16 h-16 rounded-full bg-gradient-to-r from-indigo-500 to-purple-500 flex items-center justify-center overflow-hidden">
                        <template x-if="userSettings.avatarUrl || currentUser.avatar_url">
                            <img :src="userSettings.avatarUrl || currentUser.avatar_url" class="w-full h-full object-cover">
                        </template>
                        <template x-if="!userSettings.avatarUrl && !currentUser.avatar_url">
                            <span class="text-white text-2xl font-medium" x-text="currentUser.username ? currentUser.username.substring(0,1).toUpperCase() : 'U'"></span>
                        </template>
                    </div>
                    <div class="flex-1">
                        <label class="block text-sm font-medium mb-1">URL —Ñ–æ—Ç–æ –ø—Ä–æ—Ñ–∏–ª—è</label>
                        <input type="url"
                               class="glass w-full px-4 py-2 rounded-xl text-sm"
                               placeholder="https://example.com/photo.jpg"
                               x-model="userSettings.avatarUrl">
                    </div>
                </div>

                <!-- –ù–∏–∫–Ω–µ–π–º -->
                <div>
                    <label class="block text-sm font-medium mb-2">–ù–∏–∫–Ω–µ–π–º</label>
                    <input type="text"
                           class="glass w-full px-4 py-3 rounded-xl"
                           :placeholder="currentUser.username"
                           x-model="userSettings.newUsername">
                </div>

                <!-- –ù–æ–≤—ã–π –ø–∞—Ä–æ–ª—å -->
                <div>
                    <label class="block text-sm font-medium mb-2">–ù–æ–≤—ã–π –ø–∞—Ä–æ–ª—å</label>
                    <input type="password"
                           class="glass w-full px-4 py-3 rounded-xl"
                           placeholder="–û—Å—Ç–∞–≤—å—Ç–µ –ø—É—Å—Ç—ã–º, –µ—Å–ª–∏ –Ω–µ —Ö–æ—Ç–∏—Ç–µ –º–µ–Ω—è—Ç—å"
                           x-model="userSettings.newPassword">
                </div>

                <!-- –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –ø–∞—Ä–æ–ª—è -->
                <div x-show="userSettings.newPassword">
                    <label class="block text-sm font-medium mb-2">–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å</label>
                    <input type="password"
                           class="glass w-full px-4 py-3 rounded-xl"
                           placeholder="–ü–æ–≤—Ç–æ—Ä–∏—Ç–µ –Ω–æ–≤—ã–π –ø–∞—Ä–æ–ª—å"
                           x-model="userSettings.newPasswordConfirm">
                </div>

                <!-- –†–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å -->
                <div class="border-t border-gray-200 pt-4">
                    <h4 class="text-sm font-semibold text-gray-600 mb-3">–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞</h4>

                    <div class="grid grid-cols-2 gap-4">
                        <!-- –Ø–∑—ã–∫ -->
                        <div>
                            <label class="block text-sm font-medium mb-2">–Ø–∑—ã–∫</label>
                            <select class="glass w-full px-4 py-3 rounded-xl" x-model="language" @change="changeLanguage">
                                <option value="ru">–†—É—Å—Å–∫–∏–π</option>
                                <option value="en">English</option>
                                <option value="uk">–£–∫—Ä–∞—ó–Ω—Å—å–∫–∞</option>
                            </select>
                        </div>

                        <!-- –¢–µ–º–∞ -->
                        <div>
                            <label class="block text-sm font-medium mb-2">–¢–µ–º–∞</label>
                            <button @click="toggleDarkMode()"
                                    class="glass w-full px-4 py-3 rounded-xl flex items-center justify-between hover:bg-gray-50 transition-all">
                                <span x-text="darkMode ? '–¢—ë–º–Ω–∞—è' : '–°–≤–µ—Ç–ª–∞—è'"></span>
                                <i class="fas" :class="darkMode ? 'fa-moon text-indigo-500' : 'fa-sun text-yellow-500'"></i>
                            </button>
                        </div>
                    </div>
                </div>

                <div class="flex justify-end space-x-3 pt-4">
                    <button @click="showSettingsModal = false; resetUserSettings()" class="px-5 py-2.5 rounded-xl hover:bg-gray-100 font-medium transition-all">
                        –û—Ç–º–µ–Ω–∞
                    </button>
                    <button @click="saveUserSettings()"
                            :disabled="settingsSaving || (userSettings.newPassword && userSettings.newPassword !== userSettings.newPasswordConfirm)"
                            class="glow-button px-5 py-2.5 rounded-xl text-white font-medium disabled:opacity-50 disabled:cursor-not-allowed">
                        <span x-show="!settingsSaving">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</span>
                        <span x-show="settingsSaving"><i class="fas fa-spinner fa-spin mr-2"></i>–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ...</span>
                    </button>
                </div>
            </div>
        </div>
    </div>


    <!-- API Module -->
    <script src="public/js/api.js"></script>
    <!-- Dashboard Logic -->
    <script src="public/js/dashboard.js"></script>
</body>
</html>
